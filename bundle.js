/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function i(t,e,i){var r,s=new Promise((function(s,o){n(r=t[e].apply(t,i)).then(s,o)}));return s.request=r,s}function r(t,e,n){var r=i(t,e,n);return r.then((function(t){if(t)return new u(t,r.request)}))}function s(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function o(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return this[e][i].apply(this[e],arguments)})}))}function c(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function l(t){this._index=t}function u(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function d(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function f(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new d(n)}function p(t){this._db=t}s(l,"_index",["name","keyPath","multiEntry","unique"]),o(l,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(l,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(u,"_cursor",["direction","key","primaryKey","value"]),o(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(u.prototype[t]=function(){var e=this,i=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,i),n(e._request).then((function(t){if(t)return new u(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new l(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new l(this._store.index.apply(this._store,arguments))},s(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,l].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),i=n[n.length-1],r=this._store||this._index,s=r[t].apply(r,n.slice(0,-1));s.onsuccess=function(){i(s.result)}})}))})),[l,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,i=[];return new Promise((function(r){n.iterateCursor(t,(function(t){t?(i.push(t.value),void 0===e||i.length!=e?t.continue():r(i)):r(i)}))}))})})),t.openDb=function(t,e,n){var r=i(indexedDB,"open",[t,e]),s=r.request;return s&&(s.onupgradeneeded=function(t){n&&n(new f(s.result,t.oldVersion,s.transaction))}),r.then((function(t){return new p(t)}))},t.deleteDb=function(t){return i(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";const t=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[l],n[u],n[h],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw Error();const c=r<<2|s>>4;if(i.push(c),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},i=function(n){const i=t(n);return e.encodeByteArray(i,!0)};class r{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())}function a(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function c(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function l(){const t=s();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function u(){return"object"==typeof indexedDB}function h(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class d extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,d.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f.prototype.create)}}class f{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(p,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new d(i,o,n)}}const p=/\{\$([^}]+)}/g;function g(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(m(n)&&m(s)){if(!g(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function m(t){return null!==t&&"object"==typeof t}function y(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function v(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function w(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class I{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=b),void 0===i.error&&(i.error=b),void 0===i.complete&&(i.complete=b);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function b(){}function T(t,e=1e3,n=2){const i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function E(t){return t&&t._delegate?t._delegate:t}class _{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const S="[DEFAULT]";class k{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:S})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===S?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:S:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class A{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new k(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const C=[];var N,O;(O=N||(N={}))[O.DEBUG=0]="DEBUG",O[O.VERBOSE=1]="VERBOSE",O[O.INFO=2]="INFO",O[O.WARN=3]="WARN",O[O.ERROR=4]="ERROR",O[O.SILENT=5]="SILENT";const R={debug:N.DEBUG,verbose:N.VERBOSE,info:N.INFO,warn:N.WARN,error:N.ERROR,silent:N.SILENT},D=N.INFO,P={[N.DEBUG]:"log",[N.VERBOSE]:"log",[N.INFO]:"info",[N.WARN]:"warn",[N.ERROR]:"error"},L=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=P[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class M{constructor(t){this.name=t,this._logLevel=D,this._logHandler=L,this._userLogHandler=null,C.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in N))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?R[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,N.DEBUG,...t),this._logHandler(this,N.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,N.VERBOSE,...t),this._logHandler(this,N.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,N.INFO,...t),this._logHandler(this,N.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,N.WARN,...t),this._logHandler(this,N.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,N.ERROR,...t),this._logHandler(this,N.ERROR,...t)}}var x=n(676);class U{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const V="@firebase/app",F="0.7.18",j=new M("@firebase/app"),B={[V]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},q=new Map,$=new Map;function H(t,e){try{t.container.addComponent(e)}catch(n){j.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function K(t){const e=t.name;if($.has(e))return j.debug(`There were multiple attempts to register component ${e}.`),!1;$.set(e,t);for(const e of q.values())H(e,t);return!0}function G(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const z=new f("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class W{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw z.create("app-deleted",{appName:this._name})}}const X="9.6.8";function J(t="[DEFAULT]"){const e=q.get(t);if(!e)throw z.create("no-app",{appName:t});return e}function Q(t,e,n){var i;let r=null!==(i=B[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void j.warn(t.join(" "))}K(new _(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const Y="firebase-heartbeat-store";let Z=null;function tt(){return Z||(Z=(0,x.openDb)("firebase-heartbeat-database",1,(t=>{0===t.oldVersion&&t.createObjectStore(Y)})).catch((t=>{throw z.create("storage-open",{originalErrorMessage:t.message})}))),Z}async function et(t,e){try{const n=(await tt()).transaction(Y,"readwrite"),i=n.objectStore(Y);return await i.put(e,nt(t)),n.complete}catch(t){throw z.create("storage-set",{originalErrorMessage:t.message})}}function nt(t){return`${t.name}!${t.options.appId}`}class it{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new rt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=(new Date).toISOString().substring(0,10);if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!this._heartbeatsCache.some((t=>t.date===e)))return this._heartbeatsCache.push({date:e,userAgent:t}),this._heartbeatsCache=this._heartbeatsCache.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache)return"";const{heartbeatsToSend:t,unsentEntries:e}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.userAgent===r.userAgent));if(t){if(t.dates.push(r.date),st(n)>e){t.dates.pop();break}}else if(n.push({userAgent:r.userAgent,dates:[r.date]}),st(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache),n=i(JSON.stringify({version:2,heartbeats:t}));return e.length>0?(this._heartbeatsCache=e,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache=null,this._storage.deleteAll()),n}}class rt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!u()&&h().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{return(await tt()).transaction(Y).objectStore(Y).get(nt(t))}catch(t){throw z.create("storage-get",{originalErrorMessage:t.message})}}(this.app);return(null==t?void 0:t.heartbeats)||[]}return[]}async overwrite(t){return await this._canUseIndexedDBPromise?et(this.app,{heartbeats:t}):void 0}async add(t){if(await this._canUseIndexedDBPromise){const e=await this.read();return et(this.app,{heartbeats:[...e,...t]})}}async delete(t){if(await this._canUseIndexedDBPromise){const e=await this.read();return et(this.app,{heartbeats:e.filter((e=>!t.includes(e)))})}}async deleteAll(){return await this._canUseIndexedDBPromise?async function(t){try{const e=(await tt()).transaction(Y,"readwrite");return await e.objectStore(Y).delete(nt(t)),e.complete}catch(t){throw z.create("storage-delete",{originalErrorMessage:t.message})}}(this.app):void 0}}function st(t){return i(JSON.stringify({version:2,heartbeats:t})).length}K(new _("platform-logger",(t=>new U(t)),"PRIVATE")),K(new _("heartbeat",(t=>new it(t)),"PRIVATE")),Q(V,F,""),Q(V,F,"esm2017"),Q("fire-js",""),Q("firebase","9.6.8","app");const ot="@firebase/installations",at="0.5.5",ct="w:0.5.5",lt=new f("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ut(t){return t instanceof d&&t.code.includes("request-failed")}function ht({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function dt(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function ft(t,e){const n=(await e.json()).error;return lt.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function pt({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function gt(t){const e=await t();return e.status>=500&&e.status<600?t():e}function mt(t){return new Promise((e=>{setTimeout(e,t)}))}const yt=/^[cdef][\w-]{21}$/;function vt(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return yt.test(e)?e:""}catch(t){return""}}function wt(t){return`${t.appName}!${t.appId}`}const It=new Map;function bt(t,e){const n=wt(t);Tt(n,e),function(t,e){const n=(!Et&&"BroadcastChannel"in self&&(Et=new BroadcastChannel("[Firebase] FID Change"),Et.onmessage=t=>{Tt(t.data.key,t.data.fid)}),Et);n&&n.postMessage({key:t,fid:e}),0===It.size&&Et&&(Et.close(),Et=null)}(n,e)}function Tt(t,e){const n=It.get(t);if(n)for(const t of n)t(e)}let Et=null;const _t="firebase-installations-store";let St=null;function kt(){return St||(St=(0,x.openDb)("firebase-installations-database",1,(t=>{0===t.oldVersion&&t.createObjectStore(_t)}))),St}async function At(t,e){const n=wt(t),i=(await kt()).transaction(_t,"readwrite"),r=i.objectStore(_t),s=await r.get(n);return await r.put(e,n),await i.complete,s&&s.fid===e.fid||bt(t,e.fid),e}async function Ct(t){const e=wt(t),n=(await kt()).transaction(_t,"readwrite");await n.objectStore(_t).delete(e),await n.complete}async function Nt(t,e){const n=wt(t),i=(await kt()).transaction(_t,"readwrite"),r=i.objectStore(_t),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.complete,!o||s&&s.fid===o.fid||bt(t,o.fid),o}async function Ot(t){let e;const n=await Nt(t,(n=>{const i=function(t){return Pt(t||{fid:vt(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(lt.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function(t,{fid:e}){const n=ht(t),i=pt(t),r={fid:e,authVersion:"FIS_v2",appId:t.appId,sdkVersion:ct},s={method:"POST",headers:i,body:JSON.stringify(r)},o=await gt((()=>fetch(n,s)));if(o.ok){const t=await o.json();return{fid:t.fid||e,registrationStatus:2,refreshToken:t.refreshToken,authToken:dt(t.authToken)}}throw await ft("Create Installation",o)}(t,e);return At(t,n)}catch(n){throw ut(n)&&409===n.customData.serverCode?await Ct(t):await At(t,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Rt(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Rt(t){let e=await Dt(t);for(;1===e.registrationStatus;)await mt(100),e=await Dt(t);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Ot(t);return n||e}return e}function Dt(t){return Nt(t,(t=>{if(!t)throw lt.create("installation-not-found");return Pt(t)}))}function Pt(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Lt({appConfig:t,platformLoggerProvider:e},n){const i=function(t,{fid:e}){return`${ht(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=pt(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});s&&r.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:ct}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await gt((()=>fetch(i,a)));if(c.ok)return dt(await c.json());throw await ft("Generate Auth Token",c)}async function Mt(t,e=!1){let n;const i=await Nt(t.appConfig,(i=>{if(!Ut(i))throw lt.create("not-registered");const r=i.authToken;if(!e&&(2===(s=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(t,e){let n=await xt(t.appConfig);for(;1===n.authToken.requestStatus;)await mt(100),n=await xt(t.appConfig);const i=n.authToken;return 0===i.requestStatus?Mt(t,e):i}(t,e),i;{if(!navigator.onLine)throw lt.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await Lt(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await At(t.appConfig,i),n}catch(n){if(!ut(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await At(t.appConfig,n)}else await Ct(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function xt(t){return Nt(t,(t=>{if(!Ut(t))throw lt.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Ut(t){return void 0!==t&&2===t.registrationStatus}function Vt(t){return lt.create("missing-app-config-values",{valueName:t})}const Ft="installations";K(new _(Ft,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw Vt("App Configuration");if(!t.name)throw Vt("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Vt(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,platformLoggerProvider:G(e,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),K(new _("installations-internal",(t=>{const e=G(t.getProvider("app").getImmediate(),Ft).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await Ot(e.appConfig);return i?i.catch(console.error):Mt(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Ot(t);e&&await e}(n.appConfig),(await Mt(n,e)).token}(e,t)}}),"PRIVATE")),Q(ot,at),Q(ot,at,"esm2017");const jt="analytics",Bt="https://www.googletagmanager.com/gtag/js",qt=new M("@firebase/analytics");function $t(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const Ht=new f("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Kt=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Gt(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function zt(t,e=Kt,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw Ht.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Ht.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Xt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Wt({appId:i,apiKey:r,measurementId:s},o,a,e)}async function Wt(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=Kt){const{appId:s,measurementId:o}=t;try{await function(t,e){return new Promise(((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(s),i(Ht.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(o)return qt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:Gt(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw Ht.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(s),e}catch(e){if(!function(t){if(!(t instanceof d&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(r.deleteThrottleMetadata(s),o)return qt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}const a=503===Number(e.customData.httpStatus)?T(n,r.intervalMillis,30):T(n,r.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return r.setThrottleMetadata(s,c),qt.debug(`Calling attemptFetch again in ${a} millis`),Wt(t,c,i,r)}}class Xt{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}class Jt{constructor(t){this.app=t}_delete(){return delete Qt[this.app.options.appId],Promise.resolve()}}let Qt={},Yt=[];const Zt={};let te,ee,ne="dataLayer",ie=!1;function re(t,e,n){!function(){const t=[];if(a()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=Ht.create("invalid-analytics-context",{errorInfo:e});qt.warn(n.message)}}();const i=t.options.appId;if(!i)throw Ht.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Ht.create("no-api-key");qt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Qt[i])throw Ht.create("already-exists",{id:i});if(!ie){!function(t){let e=[];Array.isArray(window.dataLayer)?e=window.dataLayer:window.dataLayer=e}();const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(t,e,n,i){return async function(r,s,o){try{"event"===r?await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await $t(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(t){qt.error(t)}}(t,e,n,s,o):"config"===r?await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await $t(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(t){qt.error(t)}t("config",r,s)}(t,e,n,i,s,o):t("set",s)}catch(t){qt.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window.gtag}}(Qt,Yt,Zt);ee=t,te=e,ie=!0}return Qt[i]=async function(t,e,n,i,r,s,o){var a;const c=zt(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&qt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>qt.error(t))),e.push(c);const l=async function(){if(!u())return qt.warn(Ht.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await h()}catch(t){return qt.warn(Ht.create("indexeddb-unavailable",{errorInfo:t}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[d,f]=await Promise.all([c,l]);(function(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Bt))return e;return null})()||function(t,e){const n=document.createElement("script");n.src=`${Bt}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(s,d.measurementId),r("js",new Date);const p=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),r("config",d.measurementId,p),d.measurementId}(t,Yt,Zt,e,te,ne,n),new Jt(t)}const se="@firebase/analytics",oe="0.7.5";function ae(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}K(new _(jt,((t,{options:e})=>re(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),K(new _("analytics-internal",(function(t){try{const e=t.getProvider(jt).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=E(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(ee,Qt[t.app.options.appId],e,n,i).catch((t=>qt.error(t)))}(e,t,n,i)}}catch(t){throw Ht.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Q(se,oe),Q(se,oe,"esm2017"),Object.create,Object.create;const ce=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},le=new f("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ue=new M("@firebase/auth");function he(t,...e){ue.logLevel<=N.ERROR&&ue.error(`Auth (9.6.8): ${t}`,...e)}function de(t,...e){throw pe(t,...e)}function fe(t,...e){return pe(t,...e)}function pe(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return le.create(t,...e)}function ge(t,e,...n){if(!t)throw pe(e,...n)}function me(t){const e="INTERNAL ASSERTION FAILED: "+t;throw he(e),new Error(e)}function ye(t,e){t||me(e)}const ve=new Map;function we(t){ye(t instanceof Function,"Expected a class definition");let e=ve.get(t);return e?(ye(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ve.set(t,e),e)}function Ie(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function be(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class Te{constructor(t,e){this.shortDelay=t,this.longDelay=e,ye(e>t,"Short delay should be less than long delay!"),this.isMobile=o()||c()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===be()||"https:"===be()||a()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ee(t,e){ye(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class _e{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void me("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void me("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void me("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Se={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},ke=new Te(3e4,6e4);function Ae(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ce(t,e,n,i,r={}){return Ne(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=y(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),_e.fetch()(Re(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Ne(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Se),e);try{const e=new De(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Pe(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Pe(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Pe(t,"email-already-in-use",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},ce()),{[e]:n});return new f("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);de(t,a)}}catch(e){if(e instanceof d)throw e;de(t,"network-request-failed")}}async function Oe(t,e,n,i,r={}){const s=await Ce(t,e,n,i,r);return"mfaPendingCredential"in s&&de(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Re(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Ee(t.config,r):`${t.config.apiScheme}://${r}`}class De{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(fe(this.auth,"network-request-failed"))),ke.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Pe(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=fe(t,e,i);return r.customData._tokenResponse=n,r}function Le(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function Me(t){return 1e3*Number(t)}function xe(t){const[n,i,r]=t.split(".");if(void 0===n||void 0===i||void 0===r)return he("JWT malformed, contained fewer than 3 sections"),null;try{const t=function(t){try{return e.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return t?JSON.parse(t):(he("Failed to decode base64 JWT payload"),null)}catch(t){return he("Caught error parsing JWT payload as JSON",t),null}}async function Ue(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof d&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Ve{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class Fe{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Le(this.lastLoginAt),this.creationTime=Le(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function je(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Ue(t,async function(t,e){return Ce(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));ge(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=ae(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const u=t.isAnonymous,h=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Fe(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class Be{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ge(t.idToken,"internal-error"),ge(void 0!==t.idToken,"internal-error"),ge(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=xe(t);return ge(e,"internal-error"),ge(void 0!==e.exp,"internal-error"),ge(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return ge(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await Ne(t,{},(async()=>{const n=y({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Re(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",_e.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new Be;return n&&(ge("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(ge("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(ge("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Be,this.toJSON())}_performRefresh(){return me("not implemented")}}function qe(t,e){ge("string"==typeof t||void 0===t,"internal-error",{appName:e})}class $e{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=ae(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ve(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Fe(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Ue(this,this.stsTokenManager.getToken(this.auth,t));return ge(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=E(t),i=await n.getIdToken(e),r=xe(i);ge(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Le(Me(r.auth_time)),issuedAtTime:Le(Me(r.iat)),expirationTime:Le(Me(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=E(t);await je(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(ge(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new $e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await je(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Ue(this,async function(t,e){return Ce(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,l;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:T}=e;ge(v&&T,t,"internal-error");const E=Be.fromJSON(this.name,T);ge("string"==typeof v,t,"internal-error"),qe(u,t.name),qe(h,t.name),ge("boolean"==typeof w,t,"internal-error"),ge("boolean"==typeof I,t,"internal-error"),qe(d,t.name),qe(f,t.name),qe(p,t.name),qe(g,t.name),qe(m,t.name),qe(y,t.name);const _=new $e({uid:v,auth:t,email:h,emailVerified:w,displayName:u,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(_.providerData=b.map((t=>Object.assign({},t)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(t,e,n=!1){const i=new Be;i.updateFromServerResponse(e);const r=new $e({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await je(r),r}}class He{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}He.type="NONE";const Ke=He;function Ge(t,e,n){return`firebase:${t}:${e}:${n}`}class ze{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Ge(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ge("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?$e._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new ze(we(Ke),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||we(Ke);const s=Ge(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=$e._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new ze(r,t,n)):new ze(r,t,n)}}function We(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ye(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Xe(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tn(e))return"Blackberry";if(en(e))return"Webos";if(Je(e))return"Safari";if((e.includes("chrome/")||Qe(e))&&!e.includes("edge/"))return"Chrome";if(Ze(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Xe(t=s()){return/firefox\//i.test(t)}function Je(t=s()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qe(t=s()){return/crios\//i.test(t)}function Ye(t=s()){return/iemobile/i.test(t)}function Ze(t=s()){return/android/i.test(t)}function tn(t=s()){return/blackberry/i.test(t)}function en(t=s()){return/webos/i.test(t)}function nn(t=s()){return/iphone|ipad|ipod/i.test(t)}function rn(t=s()){return nn(t)||Ze(t)||en(t)||tn(t)||/windows phone/i.test(t)||Ye(t)}function sn(t,e=[]){let n;switch(t){case"Browser":n=We(s());break;case"Worker":n=`${We(s())}-${t}`;break;default:n=t}return`${n}/JsCore/9.6.8/${e.length?e.join(","):"FirebaseCore-web"}`}class on{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cn(this),this.idTokenSubscription=new cn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=le,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=we(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ze.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(t);i&&i!==r||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await je(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?E(t):null;return e&&ge(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&ge(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(we(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new f("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&we(t)||this._popupRedirectResolver;ge(e,this,"argument-error"),this.redirectPersistenceManager=await ze.create(this,[we(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return ge(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=sn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId),t}}function an(t){return E(t)}class cn{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new I(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class ln{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return me("not implemented")}_getIdTokenResponse(t){return me("not implemented")}_linkToIdToken(t,e){return me("not implemented")}_getReauthenticationResolver(t){return me("not implemented")}}class un extends ln{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new un(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new un(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return Oe(t,"POST","/v1/accounts:signInWithPassword",Ae(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Oe(t,"POST","/v1/accounts:signInWithEmailLink",Ae(t,e))}(t,{email:this._email,oobCode:this._password});default:de(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return Ce(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Oe(t,"POST","/v1/accounts:signInWithEmailLink",Ae(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:de(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function hn(t,e){return Oe(t,"POST","/v1/accounts:signInWithIdp",Ae(t,e))}class dn extends ln{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new dn(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):de("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=ae(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new dn(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return hn(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,hn(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,hn(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=y(e)}return t}}const fn={USER_NOT_FOUND:"user-not-found"};class pn extends ln{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new pn({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new pn({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Oe(t,"POST","/v1/accounts:signInWithPhoneNumber",Ae(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Oe(t,"POST","/v1/accounts:signInWithPhoneNumber",Ae(t,e));if(n.temporaryProof)throw Pe(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Oe(t,"POST","/v1/accounts:signInWithPhoneNumber",Ae(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),fn)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new pn({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class gn{constructor(t){var e,n,i,r,s,o;const a=v(w(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);ge(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=v(w(t)).link,n=e?v(w(e)).deep_link_id:null,i=v(w(t)).deep_link_id;return(i?v(w(i)).link:null)||i||n||e||t}(t);try{return new gn(e)}catch(t){return null}}}class mn{constructor(){this.providerId=mn.PROVIDER_ID}static credential(t,e){return un._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=gn.parseLink(e);return ge(n,"argument-error"),un._fromEmailAndCode(t,n.code,n.tenantId)}}mn.PROVIDER_ID="password",mn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",mn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yn{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class vn extends yn{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class wn extends vn{constructor(){super("facebook.com")}static credential(t){return dn._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return wn.credentialFromTaggedObject(t)}static credentialFromError(t){return wn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return wn.credential(t.oauthAccessToken)}catch(t){return null}}}wn.FACEBOOK_SIGN_IN_METHOD="facebook.com",wn.PROVIDER_ID="facebook.com";class In extends vn{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return dn._fromParams({providerId:In.PROVIDER_ID,signInMethod:In.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return In.credentialFromTaggedObject(t)}static credentialFromError(t){return In.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return In.credential(e,n)}catch(t){return null}}}In.GOOGLE_SIGN_IN_METHOD="google.com",In.PROVIDER_ID="google.com";class bn extends vn{constructor(){super("github.com")}static credential(t){return dn._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return bn.credentialFromTaggedObject(t)}static credentialFromError(t){return bn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return bn.credential(t.oauthAccessToken)}catch(t){return null}}}bn.GITHUB_SIGN_IN_METHOD="github.com",bn.PROVIDER_ID="github.com";class Tn extends vn{constructor(){super("twitter.com")}static credential(t,e){return dn._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Tn.credentialFromTaggedObject(t)}static credentialFromError(t){return Tn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return Tn.credential(e,n)}catch(t){return null}}}Tn.TWITTER_SIGN_IN_METHOD="twitter.com",Tn.PROVIDER_ID="twitter.com";class En{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await $e._fromIdTokenResponse(t,n,i),s=_n(n);return new En({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=_n(n);return new En({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function _n(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Sn extends d{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sn.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Sn(t,e,n,i)}}function kn(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Sn._fromErrorAndOperation(t,n,e,i);throw n}))}async function An(t,e,n=!1){const i="signIn",r=await kn(t,i,e),s=await En._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}new WeakMap;const Cn="__sak";class Nn{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Cn,"1"),this.storage.removeItem(Cn),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class On extends Nn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=s();return Je(t)||nn(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=rn(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);l()&&10===document.documentMode&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}On.type="LOCAL";const Rn=On;class Dn extends Nn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Dn.type="SESSION";const Pn=Dn;class Ln{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Ln(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Mn(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Ln.receivers=[];class xn{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Mn("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Un(){return window}function Vn(){return void 0!==Un().WorkerGlobalScope&&"function"==typeof Un().importScripts}const Fn="firebaseLocalStorageDb",jn="firebaseLocalStorage",Bn="fbase_key";class qn{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function $n(t,e){return t.transaction([jn],e?"readwrite":"readonly").objectStore(jn)}function Hn(){const t=indexedDB.open(Fn,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(jn,{keyPath:Bn})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(jn)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Fn);return new qn(t).toPromise()}(),e(await Hn()))}))}))}async function Kn(t,e,n){const i=$n(t,!0).put({[Bn]:e,value:n});return new qn(i).toPromise()}function Gn(t,e){const n=$n(t,!0).delete(e);return new qn(n).toPromise()}class zn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Hn()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Vn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ln._getInstance(Vn()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new xn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Hn();return await Kn(t,Cn,"1"),await Gn(t,Cn),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Kn(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=$n(t,!1).get(e),i=await new qn(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Gn(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=$n(t,!1).getAll();return new qn(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}zn.type="LOCAL";const Wn=zn;function Xn(t){return`__${t}${Math.floor(1e6*Math.random())}`}Xn("rcb"),new Te(3e4,6e4);class Jn{constructor(t){this.providerId=Jn.PROVIDER_ID,this.auth=an(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(ge("string"==typeof r,t,"argument-error"),ge("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){ge("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Ce(t,"POST","/v2/accounts/mfaEnrollment:start",Ae(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{ge("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;ge(n,t,"missing-multi-factor-info");const o=await function(t,e){return Ce(t,"POST","/v2/accounts/mfaSignIn:start",Ae(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Ce(t,"POST","/v1/accounts:sendVerificationCode",Ae(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,E(e))}static credential(t,e){return pn._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Jn.credentialFromTaggedObject(e)}static credentialFromError(t){return Jn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?pn._fromTokenResponse(e,n):null}}Jn.PROVIDER_ID="phone",Jn.PHONE_SIGN_IN_METHOD="phone";class Qn extends ln{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return hn(t,this._buildIdpRequest())}_linkToIdToken(t,e){return hn(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return hn(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Yn(t){return An(t.auth,new Qn(t),t.bypassAuthState)}function Zn(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await Ue(t,kn(i,r,e,t),n);ge(s.idToken,i,"internal-error");const o=xe(s.idToken);ge(o,i,"internal-error");const{sub:a}=o;return ge(t.uid===a,i,"user-mismatch"),En._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&de(i,"user-mismatch"),t}}(n,new Qn(t),t.bypassAuthState)}async function ti(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),async function(t,e,n=!1){const i=await Ue(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return En._forOperation(t,"link",i)}(n,new Qn(t),t.bypassAuthState)}class ei{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Yn;case"linkViaPopup":case"linkViaRedirect":return ti;case"reauthViaPopup":case"reauthViaRedirect":return Zn;default:de(this.auth,"internal-error")}}resolve(t){ye(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ye(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ni=new Te(2e3,1e4);class ii extends ei{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,ii.currentPopupAction&&ii.currentPopupAction.cancel(),ii.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ge(t,this.auth,"internal-error"),t}async onExecution(){ye(1===this.filter.length,"Popup operations only handle one event");const t=Mn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(fe(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(fe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ii.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(fe(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,ni.get())};t()}}ii.currentPopupAction=null;const ri=new Map;class si extends ei{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=ri.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Ge("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return we(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}ri.set(this.auth._key(),t)}return this.bypassAuthState||ri.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function oi(t,e,n=!1){const i=an(t),r=function(t,e){return e?we(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new si(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class ai{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return li(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!li(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(fe(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ci(t))}saveEventToCache(t){this.cachedEventUids.add(ci(t)),this.lastProcessedEventTime=Date.now()}}function ci(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function li({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const ui=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hi=/^https?/;function di(t){const e=Ie(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!hi.test(n))return!1;if(ui.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const fi=new Te(3e4,6e4);function pi(){const t=Un().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let gi=null;function mi(t){return gi=gi||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){pi(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pi(),n(fe(t,"network-request-failed"))},timeout:fi.get()})}if(null===(r=null===(i=Un().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Un().gapi)||void 0===s?void 0:s.load)){const e=Xn("iframefcb");return Un()[e]=()=>{gapi.load?a():n(fe(t,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=fe("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(n)}))).catch((t=>n(t)))}a()}})).catch((t=>{throw gi=null,t}))}(t),gi}const yi=new Te(5e3,15e3),vi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ii(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ee(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:X},r=wi.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${y(i).slice(1)}`}const bi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ti{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function Ei(t,e,n,i,r,s){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:X,eventId:r};if(e instanceof yn){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof vn){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];return`${function({config:t}){return t.emulator?Ee(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${y(a).slice(1)}`}const _i="webStorageSupport",Si=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pn,this._completeRedirectFn=oi}async _openPopup(t,e,n,i){var r;return ye(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const l=Object.assign(Object.assign({},bi),{width:i.toString(),height:r.toString(),top:o,left:a}),u=s().toLowerCase();n&&(c=Qe(u)?"_blank":n),Xe(u)&&(e=e||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=s()){var e;return nn(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new Ti(null);const d=window.open(e||"",c,h);ge(d,t,"popup-blocked");try{d.focus()}catch(t){}return new Ti(d)}(t,Ei(t,e,n,Ie(),i),Mn())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=Ei(t,e,n,Ie(),i),Un().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(ye(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await mi(t),n=Un().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:Ii(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vi,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=fe(t,"network-request-failed"),s=Un().setTimeout((()=>{i(r)}),yi.get());function o(){Un().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new ai(t);return e.register("authEvent",(e=>(ge(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(_i,{type:_i},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==r&&e(!!r),de(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Ce(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(di(t))return}catch(t){}de(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return rn()||Je()||nn()}};var ki,Ai="@firebase/auth",Ci="0.19.9";class Ni{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}ki="Browser",K(new _("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:i,authDomain:r}=n.options;return(t=>{ge(i&&!i.includes(":"),"invalid-api-key",{appName:t.name}),ge(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const n={apiKey:i,authDomain:r,clientPlatform:ki,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sn(ki)},s=new on(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(we);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(s,e),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),K(new _("auth-internal",(t=>(t=>new Ni(t))(an(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Q(Ai,Ci,void 0),Q(Ai,Ci,"esm2017");var Oi,Ri="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Di={},Pi=Pi||{},Li=Ri||self;function Mi(){}function xi(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ui(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Vi="closure_uid_"+(1e9*Math.random()>>>0),Fi=0;function ji(t,e,n){return t.call.apply(t.bind,arguments)}function Bi(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function qi(t,e,n){return(qi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ji:Bi).apply(null,arguments)}function $i(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Hi(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Ki(){this.s=this.s,this.o=this.o}var Gi={};Ki.prototype.s=!1,Ki.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Vi)&&t[Vi]||(t[Vi]=++Fi)}(this);delete Gi[t]}},Ki.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const zi=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Wi=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,r="string"==typeof t?t.split(""):t;for(let s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function Xi(t){return Array.prototype.concat.apply([],arguments)}function Ji(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Qi(t){return/^[\s\xa0]*$/.test(t)}var Yi,Zi=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function tr(t,e){return-1!=t.indexOf(e)}function er(t,e){return t<e?-1:t>e?1:0}t:{var nr=Li.navigator;if(nr){var ir=nr.userAgent;if(ir){Yi=ir;break t}}Yi=""}function rr(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function sr(t){const e={};for(const n in t)e[n]=t[n];return e}var or="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ar(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<or.length;e++)n=or[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function cr(t){return cr[" "](t),t}cr[" "]=Mi;var lr,ur,hr=tr(Yi,"Opera"),dr=tr(Yi,"Trident")||tr(Yi,"MSIE"),fr=tr(Yi,"Edge"),pr=fr||dr,gr=tr(Yi,"Gecko")&&!(tr(Yi.toLowerCase(),"webkit")&&!tr(Yi,"Edge"))&&!(tr(Yi,"Trident")||tr(Yi,"MSIE"))&&!tr(Yi,"Edge"),mr=tr(Yi.toLowerCase(),"webkit")&&!tr(Yi,"Edge");function yr(){var t=Li.document;return t?t.documentMode:void 0}t:{var vr="",wr=(ur=Yi,gr?/rv:([^\);]+)(\)|;)/.exec(ur):fr?/Edge\/([\d\.]+)/.exec(ur):dr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ur):mr?/WebKit\/(\S+)/.exec(ur):hr?/(?:Version)[ \/]?(\S+)/.exec(ur):void 0);if(wr&&(vr=wr?wr[1]:""),dr){var Ir=yr();if(null!=Ir&&Ir>parseFloat(vr)){lr=String(Ir);break t}}lr=vr}var br,Tr={};function Er(){return t=Tr,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=Zi(String(lr)).split("."),n=Zi("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=er(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||er(0==r[2].length,0==s[2].length)||er(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}();var t}Li.document&&dr?br=yr()||parseInt(lr,10)||void 0:br=void 0;var _r=br,Sr=function(){if(!Li.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Li.addEventListener("test",Mi,e),Li.removeEventListener("test",Mi,e)}catch(t){}return t}();function kr(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Ar(t,e){if(kr.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(gr){t:{try{cr(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Cr[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ar.Z.h.call(this)}}kr.prototype.h=function(){this.defaultPrevented=!0},Hi(Ar,kr);var Cr={2:"touch",3:"pen",4:"mouse"};Ar.prototype.h=function(){Ar.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Nr="closure_listenable_"+(1e6*Math.random()|0),Or=0;function Rr(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=r,this.key=++Or,this.ca=this.fa=!1}function Dr(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Pr(t){this.src=t,this.g={},this.h=0}function Lr(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=zi(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Dr(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Mr(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==i)return r}return-1}Pr.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Mr(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new Rr(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var xr="closure_lm_"+(1e6*Math.random()|0),Ur={};function Vr(t,e,n,i,r){if(i&&i.once)return jr(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Vr(t,e[s],n,i,r);return null}return n=zr(n),t&&t[Nr]?t.N(e,n,Ui(i)?!!i.capture:!!i,r):Fr(t,e,n,!1,i,r)}function Fr(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Ui(r)?!!r.capture:!!r,a=Kr(t);if(a||(t[xr]=a=new Pr(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){var t=Hr;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Sr||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent($r(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function jr(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jr(t,e[s],n,i,r);return null}return n=zr(n),t&&t[Nr]?t.O(e,n,Ui(i)?!!i.capture:!!i,r):Fr(t,e,n,!0,i,r)}function Br(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Br(t,e[s],n,i,r);else i=Ui(i)?!!i.capture:!!i,n=zr(n),t&&t[Nr]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Mr(s=t.g[e],n,i,r))&&(Dr(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Kr(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Mr(e,n,i,r)),(n=-1<t?e[t]:null)&&qr(n))}function qr(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Nr])Lr(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent($r(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Kr(e))?(Lr(n,t),0==n.h&&(n.src=null,e[xr]=null)):Dr(t)}}}function $r(t){return t in Ur?Ur[t]:Ur[t]="on"+t}function Hr(t,e){if(t.ca)t=!0;else{e=new Ar(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&qr(t),t=n.call(i,e)}return t}function Kr(t){return(t=t[xr])instanceof Pr?t:null}var Gr="__closure_events_fn_"+(1e9*Math.random()>>>0);function zr(t){return"function"==typeof t?t:(t[Gr]||(t[Gr]=function(e){return t.handleEvent(e)}),t[Gr])}function Wr(){Ki.call(this),this.i=new Pr(this),this.P=this,this.I=null}function Xr(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new kr(e,t);else if(e instanceof kr)e.target=e.target||t;else{var r=e;ar(e=new kr(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Jr(o,i,!0,e)&&r}if(r=Jr(o=e.g=t,i,!0,e)&&r,r=Jr(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Jr(o=e.g=n[s],i,!1,e)&&r}function Jr(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Lr(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Hi(Wr,Ki),Wr.prototype[Nr]=!0,Wr.prototype.removeEventListener=function(t,e,n,i){Br(this,t,e,n,i)},Wr.prototype.M=function(){if(Wr.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Dr(n[i]);delete e.g[t],e.h--}}this.I=null},Wr.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Wr.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Qr=Li.JSON.stringify;function Yr(){var t=ss;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Zr,ts=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new es),(t=>t.reset()));class es{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function ns(t){Li.setTimeout((()=>{throw t}),0)}function is(t,e){Zr||function(){var t=Li.Promise.resolve(void 0);Zr=function(){t.then(os)}}(),rs||(Zr(),rs=!0),ss.add(t,e)}var rs=!1,ss=new class{constructor(){this.h=this.g=null}add(t,e){const n=ts.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function os(){for(var t;t=Yr();){try{t.h.call(t.g)}catch(t){ns(t)}var e=ts;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}rs=!1}function as(t,e){Wr.call(this),this.h=t||1,this.g=e||Li,this.j=qi(this.kb,this),this.l=Date.now()}function cs(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ls(t,e,n){if("function"==typeof t)n&&(t=qi(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=qi(t.handleEvent,t)}return 2147483647<Number(e)?-1:Li.setTimeout(t,e||0)}function us(t){t.g=ls((()=>{t.g=null,t.i&&(t.i=!1,us(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Hi(as,Wr),(Oi=as.prototype).da=!1,Oi.S=null,Oi.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Xr(this,"tick"),this.da&&(cs(this),this.start()))}},Oi.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Oi.M=function(){as.Z.M.call(this),cs(this),delete this.g};class hs extends Ki{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:us(this)}M(){super.M(),this.g&&(Li.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ds(t){Ki.call(this),this.h=t,this.g={}}Hi(ds,Ki);var fs=[];function ps(t,e,n,i){Array.isArray(n)||(n&&(fs[0]=n.toString()),n=fs);for(var r=0;r<n.length;r++){var s=Vr(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function gs(t){rr(t.g,(function(t,e){this.g.hasOwnProperty(e)&&qr(t)}),t),t.g={}}function ms(){this.g=!0}function ys(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Qr(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}ds.prototype.M=function(){ds.Z.M.call(this),gs(this)},ds.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ms.prototype.Aa=function(){this.g=!1},ms.prototype.info=function(){};var vs={},ws=null;function Is(){return ws=ws||new Wr}function bs(t){kr.call(this,vs.Ma,t)}function Ts(t){const e=Is();Xr(e,new bs(e,t))}function Es(t,e){kr.call(this,vs.STAT_EVENT,t),this.stat=e}function _s(t){const e=Is();Xr(e,new Es(e,t))}function Ss(t,e){kr.call(this,vs.Na,t),this.size=e}function ks(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Li.setTimeout((function(){t()}),e)}vs.Ma="serverreachability",Hi(bs,kr),vs.STAT_EVENT="statevent",Hi(Es,kr),vs.Na="timingevent",Hi(Ss,kr);var As={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Cs={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Ns(){}function Os(t){return t.h||(t.h=t.i())}function Rs(){}Ns.prototype.h=null;var Ds,Ps={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Ls(){kr.call(this,"d")}function Ms(){kr.call(this,"c")}function xs(){}function Us(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new ds(this),this.P=Fs,t=pr?125:void 0,this.W=new as(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Vs}function Vs(){this.i=null,this.g="",this.h=!1}Hi(Ls,kr),Hi(Ms,kr),Hi(xs,Ns),xs.prototype.g=function(){return new XMLHttpRequest},xs.prototype.i=function(){return{}},Ds=new xs;var Fs=45e3,js={},Bs={};function qs(t,e,n){t.K=1,t.v=ho(so(e)),t.s=n,t.U=!0,$s(t,null)}function $s(t,e){t.F=Date.now(),zs(t),t.A=so(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),So(n.h,"t",i),t.C=0,n=t.l.H,t.h=new Vs,t.g=Sa(t.l,n?e:null,!t.s),0<t.O&&(t.L=new hs(qi(t.Ia,t,t.g),t.O)),ps(t.V,t.g,"readystatechange",t.gb),e=t.H?sr(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ts(1),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Hs(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Ks(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=Gs(t,n),i==Bs){4==e&&(t.o=4,_s(14),r=!1),ys(t.j,t.m,null,"[Incomplete Response]");break}if(i==js){t.o=4,_s(15),ys(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}ys(t.j,t.m,i,null),Ys(t,i)}Hs(t)&&i!=Bs&&i!=js&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,_s(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),ya(e),e.L=!0,_s(11))):(ys(t.j,t.m,n,"[Invalid Chunked Response]"),Qs(t),Js(t))}function Gs(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Bs:(n=Number(e.substring(n,i)),isNaN(n)?js:(i+=1)+n>e.length?Bs:(e=e.substr(i,n),t.C=i+n,e))}function zs(t){t.Y=Date.now()+t.P,Ws(t,t.P)}function Ws(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ks(qi(t.eb,t),e)}function Xs(t){t.B&&(Li.clearTimeout(t.B),t.B=null)}function Js(t){0==t.l.G||t.I||Ia(t.l,t)}function Qs(t){Xs(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,cs(t.W),gs(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ys(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Ro(n.i,t)))if(n.I=t.N,!t.J&&Ro(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;wa(n),ca(n)}ma(n),_s(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=ks(qi(n.ab,n),6e3));if(1>=Oo(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else Ta(n,11)}else if((t.J||n.g==t)&&wa(n),!Qi(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.U=l[0],l=l[1],2==n.G)if("c"==l[0]){n.J=l[1],n.la=l[2];const e=l[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const r=l[4];null!=r&&(n.za=r,n.h.info("SVER="+n.za));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;!s.g&&(tr(t,"spdy")||tr(t,"quic")||tr(t,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(Do(s,s.h),s.h=null))}if(i.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,uo(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((i=n).oa=_a(i,i.H?i.la:null,i.W),o.J){Po(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Xs(a),zs(a)),i.g=o}else ga(i);0<n.l.length&&ha(n)}else"stop"!=l[0]&&"close"!=l[0]||Ta(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Ta(n,7):aa(n):"noop"!=l[0]&&n.j&&n.j.wa(l),n.A=0)}Ts(4)}catch(t){}}function Zs(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(xi(t)||"string"==typeof t)Wi(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(xi(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(xi(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function to(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof to)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function eo(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];no(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)no(r,i=t.g[e])||(t.g[n++]=i,r[i]=1),e++;t.g.length=n}}function no(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Oi=Us.prototype).setTimeout=function(t){this.P=t},Oi.gb=function(t){t=t.target;const e=this.L;e&&3==na(t)?e.l():this.Ia(t)},Oi.Ia=function(t){try{if(t==this.g)t:{const u=na(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(3!=u||pr||this.g&&(this.h.h||this.g.ga()||ia(this.g)))){this.I||4!=u||7==e||Ts(8==e||0>=h?3:2),Xs(this);var n=this.g.ba();this.N=n;e:if(Hs(this)){var i=ia(this.g);t="";var r=i.length,s=4==na(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Qs(this),Js(this);var o="";break e}this.h.i=new Li.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qi(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,_s(12),Qs(this),Js(this);break t}ys(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ys(this,n)}this.U?(Ks(this,u,o),pr&&this.i&&3==u&&(ps(this.V,this.W,"tick",this.fb),this.W.start())):(ys(this.j,this.m,o,null),Ys(this,o)),4==u&&Qs(this),this.i&&!this.I&&(4==u?Ia(this.l,this):(this.i=!1,zs(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,_s(12)):(this.o=0,_s(13)),Qs(this),Js(this)}}}catch(t){}},Oi.fb=function(){if(this.g){var t=na(this.g),e=this.g.ga();this.C<e.length&&(Xs(this),Ks(this,t,e),this.i&&4!=t&&zs(this))}},Oi.cancel=function(){this.I=!0,Qs(this)},Oi.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Ts(3),_s(17)),Qs(this),this.o=2,Js(this)):Ws(this,this.Y-t)},(Oi=to.prototype).R=function(){eo(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Oi.T=function(){return eo(this),this.g.concat()},Oi.get=function(t,e){return no(this.h,t)?this.h[t]:e},Oi.set=function(t,e){no(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Oi.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var io=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ro(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ro){this.g=void 0!==e?e:t.g,oo(this,t.j),this.s=t.s,ao(this,t.i),co(this,t.m),this.l=t.l,e=t.h;var n=new bo;n.i=e.i,e.g&&(n.g=new to(e.g),n.h=e.h),lo(this,n),this.o=t.o}else t&&(n=String(t).match(io))?(this.g=!!e,oo(this,n[1]||"",!0),this.s=fo(n[2]||""),ao(this,n[3]||"",!0),co(this,n[4]),this.l=fo(n[5]||"",!0),lo(this,n[6]||"",!0),this.o=fo(n[7]||"")):(this.g=!!e,this.h=new bo(null,this.g))}function so(t){return new ro(t)}function oo(t,e,n){t.j=n?fo(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ao(t,e,n){t.i=n?fo(e,!0):e}function co(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function lo(t,e,n){e instanceof bo?(t.h=e,function(t,e){e&&!t.j&&(To(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Eo(this,e),So(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=po(e,wo)),t.h=new bo(e,t.g))}function uo(t,e,n){t.h.set(e,n)}function ho(t){return uo(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function fo(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function po(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,go),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function go(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ro.prototype.toString=function(){var t=[],e=this.j;e&&t.push(po(e,mo,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(po(e,mo,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(po(n,"/"==n.charAt(0)?vo:yo,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",po(n,Io)),t.join("")};var mo=/[#\/\?@]/g,yo=/[#\?:]/g,vo=/[#\?]/g,wo=/[#\?@]/g,Io=/#/g;function bo(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function To(t){t.g||(t.g=new to,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Eo(t,e){To(t),e=ko(t,e),no(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,no((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&eo(t)))}function _o(t,e){return To(t),e=ko(t,e),no(t.g.h,e)}function So(t,e,n){Eo(t,e),0<n.length&&(t.i=null,t.g.set(ko(t,e),Ji(n)),t.h+=n.length)}function ko(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ao(t){this.l=t||Co,t=Li.PerformanceNavigationTiming?0<(t=Li.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Li.g&&Li.g.Ea&&Li.g.Ea()&&Li.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Oi=bo.prototype).add=function(t,e){To(this),this.i=null,t=ko(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Oi.forEach=function(t,e){To(this),this.g.forEach((function(n,i){Wi(n,(function(n){t.call(e,n,i,this)}),this)}),this)},Oi.T=function(){To(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},Oi.R=function(t){To(this);var e=[];if("string"==typeof t)_o(this,t)&&(e=Xi(e,this.g.get(ko(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Xi(e,t[n])}return e},Oi.set=function(t,e){return To(this),this.i=null,_o(this,t=ko(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Oi.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Oi.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.i=t.join("&")};var Co=10;function No(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Oo(t){return t.h?1:t.g?t.g.size:0}function Ro(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Do(t,e){t.g?t.g.add(e):t.h=e}function Po(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Lo(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Ji(t.i)}function Mo(){}function xo(){this.g=new Mo}function Uo(t,e,n){const i=n||"";try{Zs(t,(function(t,n){let r=t;Ui(t)&&(r=Qr(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Vo(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function Fo(t){this.l=t.$b||null,this.j=t.ib||!1}function jo(t,e){Wr.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Bo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ao.prototype.cancel=function(){if(this.i=Lo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Mo.prototype.stringify=function(t){return Li.JSON.stringify(t,void 0)},Mo.prototype.parse=function(t){return Li.JSON.parse(t,void 0)},Hi(Fo,Ns),Fo.prototype.g=function(){return new jo(this.l,this.j)},Fo.prototype.i=function(t){return function(){return t}}({}),Hi(jo,Wr);var Bo=0;function qo(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function $o(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ho(t)}function Ho(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Oi=jo.prototype).open=function(t,e){if(this.readyState!=Bo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ho(this)},Oi.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Li).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Oi.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$o(this)),this.readyState=Bo},Oi.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ho(this)),this.g&&(this.readyState=3,Ho(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Li.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qo(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Oi.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?$o(this):Ho(this),3==this.readyState&&qo(this)}},Oi.Ua=function(t){this.g&&(this.response=this.responseText=t,$o(this))},Oi.Ta=function(t){this.g&&(this.response=t,$o(this))},Oi.ha=function(){this.g&&$o(this)},Oi.setRequestHeader=function(t,e){this.v.append(t,e)},Oi.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Oi.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(jo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ko=Li.JSON.parse;function Go(t){Wr.call(this),this.headers=new to,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zo,this.K=this.L=!1}Hi(Go,Wr);var zo="",Wo=/^https?$/i,Xo=["POST","PUT"];function Jo(t){return"content-type"==t.toLowerCase()}function Qo(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Yo(t),ta(t)}function Yo(t){t.D||(t.D=!0,Xr(t,"complete"),Xr(t,"error"))}function Zo(t){if(t.h&&void 0!==Pi&&(!t.C[1]||4!=na(t)||2!=t.ba()))if(t.v&&4==na(t))ls(t.Fa,0,t);else if(Xr(t,"readystatechange"),4==na(t)){t.h=!1;try{const a=t.ba();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===a){var r=String(t.H).match(io)[1]||null;if(!r&&Li.self&&Li.self.location){var s=Li.self.location.protocol;r=s.substr(0,s.length-1)}i=!Wo.test(r?r.toLowerCase():"")}n=i}if(n)Xr(t,"complete"),Xr(t,"success");else{t.m=6;try{var o=2<na(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.ba()+"]",Yo(t)}}finally{ta(t)}}}function ta(t,e){if(t.g){ea(t);const n=t.g,i=t.C[0]?Mi:null;t.g=null,t.C=null,e||Xr(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function ea(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Li.clearTimeout(t.A),t.A=null)}function na(t){return t.g?t.g.readyState:0}function ia(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case zo:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ra(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return rr(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):uo(t,e,n))}function sa(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function oa(t){this.za=0,this.l=[],this.h=new ms,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=sa("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=sa("baseRetryDelayMs",5e3,t),this.$a=sa("retryDelaySeedMs",1e4,t),this.Ya=sa("forwardChannelMaxRetries",2,t),this.ra=sa("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Ao(t&&t.concurrentRequestLimit),this.Ca=new xo,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function aa(t){if(la(t),3==t.G){var e=t.V++,n=so(t.F);uo(n,"SID",t.J),uo(n,"RID",e),uo(n,"TYPE","terminate"),fa(t,n),(e=new Us(t,t.h,e,void 0)).K=2,e.v=ho(so(n)),n=!1,Li.navigator&&Li.navigator.sendBeacon&&(n=Li.navigator.sendBeacon(e.v.toString(),"")),!n&&Li.Image&&((new Image).src=e.v,n=!0),n||(e.g=Sa(e.l,null),e.g.ea(e.v)),e.F=Date.now(),zs(e)}Ea(t)}function ca(t){t.g&&(ya(t),t.g.cancel(),t.g=null)}function la(t){ca(t),t.u&&(Li.clearTimeout(t.u),t.u=null),wa(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Li.clearTimeout(t.m),t.m=null)}function ua(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&ha(t)}function ha(t){No(t.i)||t.m||(t.m=!0,is(t.Ha,t),t.C=0)}function da(t,e){var n;n=e?e.m:t.V++;const i=so(t.F);uo(i,"SID",t.J),uo(i,"RID",n),uo(i,"AID",t.U),fa(t,i),t.o&&t.s&&ra(i,t.o,t.s),n=new Us(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=pa(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Do(t.i,n),qs(n,i,e)}function fa(t,e){t.j&&Zs({},(function(t,n){uo(e,n,t)}))}function pa(t,e,n){n=Math.min(t.l.length,n);var i=t.j?qi(t.j.Oa,t.j,t):null;t:{var r=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),s=!1;else try{Uo(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function ga(t){t.g||t.u||(t.Y=1,is(t.Ga,t),t.A=0)}function ma(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=ks(qi(t.Ga,t),ba(t,t.A)),t.A++,0))}function ya(t){null!=t.B&&(Li.clearTimeout(t.B),t.B=null)}function va(t){t.g=new Us(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=so(t.oa);uo(e,"RID","rpc"),uo(e,"SID",t.J),uo(e,"CI",t.N?"0":"1"),uo(e,"AID",t.U),fa(t,e),uo(e,"TYPE","xmlhttp"),t.o&&t.s&&ra(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ho(so(e)),n.s=null,n.U=!0,$s(n,t)}function wa(t){null!=t.v&&(Li.clearTimeout(t.v),t.v=null)}function Ia(t,e){var n=null;if(t.g==e){wa(t),ya(t),t.g=null;var i=2}else{if(!Ro(t.i,e))return;n=e.D,Po(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Xr(i=Is(),new Ss(i,n,e,r)),ha(t)}else ga(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==i&&function(t,e){return!(Oo(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ks(qi(t.Ha,t,e),ba(t,t.C)),t.C++,0)))}(t,e)||2==i&&ma(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Ta(t,5);break;case 4:Ta(t,10);break;case 3:Ta(t,6);break;default:Ta(t,2)}}function ba(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Ta(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=qi(t.jb,t);n||(n=new ro("//www.google.com/images/cleardot.gif"),Li.location&&"http"==Li.location.protocol||oo(n,"https"),ho(n)),function(t,e){const n=new ms;if(Li.Image){const i=new Image;i.onload=$i(Vo,n,i,"TestLoadImage: loaded",!0,e),i.onerror=$i(Vo,n,i,"TestLoadImage: error",!1,e),i.onabort=$i(Vo,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=$i(Vo,n,i,"TestLoadImage: timeout",!1,e),Li.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else _s(2);t.G=0,t.j&&t.j.va(e),Ea(t),la(t)}function Ea(t){t.G=0,t.I=-1,t.j&&(0==Lo(t.i).length&&0==t.l.length||(t.i.i.length=0,Ji(t.l),t.l.length=0),t.j.ua())}function _a(t,e,n){let i=function(t){return t instanceof ro?so(t):new ro(t,void 0)}(n);if(""!=i.i)e&&ao(i,e+"."+i.i),co(i,i.m);else{const t=Li.location;i=function(t,e,n,i){var r=new ro(null,void 0);return t&&oo(r,t),e&&ao(r,e),n&&co(r,n),i&&(r.l=i),r}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&rr(t.aa,(function(t,e){uo(i,e,t)})),e=t.D,n=t.sa,e&&n&&uo(i,e,n),uo(i,"VER",t.ma),fa(t,i),i}function Sa(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Go(new Fo({ib:!0})):new Go(t.qa)).L=t.H,e}function ka(){}function Aa(){if(dr&&!(10<=Number(_r)))throw Error("Environmental error: no available transport.")}function Ca(t,e){Wr.call(this),this.g=new oa(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Qi(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Qi(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ra(this)}function Na(t){Ls.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Oa(){Ms.call(this),this.status=1}function Ra(t){this.g=t}(Oi=Go.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ds.g(),this.C=this.u?Os(this.u):Os(Ds),this.g.onreadystatechange=qi(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Qo(this,t)}t=n||"";const r=new to(this.headers);i&&Zs(i,(function(t,e){r.set(e,t)})),i=function(t){t:{var e=Jo;const n=t.length,i="string"==typeof t?t.split(""):t;for(let r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.T()),n=Li.FormData&&t instanceof Li.FormData,!(0<=zi(Xo,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ea(this),0<this.B&&((this.K=function(t){return dr&&Er()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=qi(this.pa,this)):this.A=ls(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Qo(this,t)}},Oi.pa=function(){void 0!==Pi&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Xr(this,"timeout"),this.abort(8))},Oi.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Xr(this,"complete"),Xr(this,"abort"),ta(this))},Oi.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ta(this,!0)),Go.Z.M.call(this)},Oi.Fa=function(){this.s||(this.F||this.v||this.l?Zo(this):this.cb())},Oi.cb=function(){Zo(this)},Oi.ba=function(){try{return 2<na(this)?this.g.status:-1}catch(t){return-1}},Oi.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Oi.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ko(e)}},Oi.Da=function(){return this.m},Oi.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Oi=oa.prototype).ma=8,Oi.G=1,Oi.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Oi.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new Us(this,this.h,t,void 0);let s=this.s;if(this.P&&(s?(s=sr(s),ar(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=pa(this,r,e),uo(n=so(this.F),"RID",t),uo(n,"CVER",22),this.D&&uo(n,"X-HTTP-Session-Id",this.D),fa(this,n),this.o&&s&&ra(n,this.o,s),Do(this.i,r),this.Ra&&uo(n,"TYPE","init"),this.ja?(uo(n,"$req",e),uo(n,"SID","null"),r.$=!0,qs(r,n,null)):qs(r,n,e),this.G=2}}else 3==this.G&&(t?da(this,t):0==this.l.length||No(this.i)||da(this))},Oi.Ga=function(){if(this.u=null,va(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ks(qi(this.bb,this),t)}},Oi.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,_s(10),ca(this),va(this))},Oi.ab=function(){null!=this.v&&(this.v=null,ca(this),ma(this),_s(19))},Oi.jb=function(t){t?(this.h.info("Successfully pinged google.com"),_s(2)):(this.h.info("Failed to ping google.com"),_s(1))},(Oi=ka.prototype).xa=function(){},Oi.wa=function(){},Oi.va=function(){},Oi.ua=function(){},Oi.Oa=function(){},Aa.prototype.g=function(t,e){return new Ca(t,e)},Hi(Ca,Wr),Ca.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),is(qi(t.hb,t,e))),_s(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=_a(t,null,t.W),ha(t)},Ca.prototype.close=function(){aa(this.g)},Ca.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,ua(this.g,e)}else this.v?((e={}).__data__=Qr(t),ua(this.g,e)):ua(this.g,t)},Ca.prototype.M=function(){this.g.j=null,delete this.j,aa(this.g),delete this.g,Ca.Z.M.call(this)},Hi(Na,Ls),Hi(Oa,Ms),Hi(Ra,ka),Ra.prototype.xa=function(){Xr(this.g,"a")},Ra.prototype.wa=function(t){Xr(this.g,new Na(t))},Ra.prototype.va=function(t){Xr(this.g,new Oa(t))},Ra.prototype.ua=function(){Xr(this.g,"b")},Aa.prototype.createWebChannel=Aa.prototype.g,Ca.prototype.send=Ca.prototype.u,Ca.prototype.open=Ca.prototype.m,Ca.prototype.close=Ca.prototype.close,As.NO_ERROR=0,As.TIMEOUT=8,As.HTTP_ERROR=6,Cs.COMPLETE="complete",Rs.EventType=Ps,Ps.OPEN="a",Ps.CLOSE="b",Ps.ERROR="c",Ps.MESSAGE="d",Wr.prototype.listen=Wr.prototype.N,Go.prototype.listenOnce=Go.prototype.O,Go.prototype.getLastError=Go.prototype.La,Go.prototype.getLastErrorCode=Go.prototype.Da,Go.prototype.getStatus=Go.prototype.ba,Go.prototype.getResponseJson=Go.prototype.Qa,Go.prototype.getResponseText=Go.prototype.ga,Go.prototype.send=Go.prototype.ea;var Da=Di.createWebChannelTransport=function(){return new Aa},Pa=Di.getStatEventTarget=function(){return Is()},La=Di.ErrorCode=As,Ma=Di.EventType=Cs,xa=Di.Event=vs,Ua=Di.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Va=Di.FetchXmlHttpFactory=Fo,Fa=Di.WebChannel=Rs,ja=Di.XhrIo=Go;const Ba="@firebase/firestore";class qa{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}qa.UNAUTHENTICATED=new qa(null),qa.GOOGLE_CREDENTIALS=new qa("google-credentials-uid"),qa.FIRST_PARTY=new qa("first-party-uid"),qa.MOCK_USER=new qa("mock-user");let $a="9.6.7";const Ha=new M("@firebase/firestore");function Ka(){return Ha.logLevel}function Ga(t,...e){if(Ha.logLevel<=N.DEBUG){const n=e.map(Xa);Ha.debug(`Firestore (${$a}): ${t}`,...n)}}function za(t,...e){if(Ha.logLevel<=N.ERROR){const n=e.map(Xa);Ha.error(`Firestore (${$a}): ${t}`,...n)}}function Wa(t,...e){if(Ha.logLevel<=N.WARN){const n=e.map(Xa);Ha.warn(`Firestore (${$a}): ${t}`,...n)}}function Xa(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ja(t="Unexpected state"){const e=`FIRESTORE (${$a}) INTERNAL ASSERTION FAILED: `+t;throw za(e),new Error(e)}function Qa(t,e){t||Ja()}function Ya(t,e){return t}const Za={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tc extends d{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ec{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class nc{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ic{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(qa.UNAUTHENTICATED)))}shutdown(){}}class rc{constructor(t){this.t=t,this.currentUser=qa.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new ec;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new ec,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ga("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ga("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new ec)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ga("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Qa("string"==typeof e.accessToken),new nc(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Qa(null===t||"string"==typeof t),new qa(t)}}class sc{constructor(t,e,n){this.type="FirstParty",this.user=qa.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class oc{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new sc(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(qa.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ac{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cc{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,e){const n=t=>{null!=t.error&&Ga("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.p;return this.p=t.token,Ga("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ga("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?i(t):Ga("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Qa("string"==typeof t.token),this.p=t.token,new ac(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class lc{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.I(t),this.T=t=>e.writeSequenceNumber(t))}I(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.T&&this.T(t),t}}function uc(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}lc.A=-1;class hc{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=uc(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function dc(t,e){return t<e?-1:t>e?1:0}function fc(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class pc{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new tc(Za.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new tc(Za.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new tc(Za.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new tc(Za.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return pc.fromMillis(Date.now())}static fromDate(t){return pc.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new pc(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?dc(this.nanoseconds,t.nanoseconds):dc(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class gc{constructor(t){this.timestamp=t}static fromTimestamp(t){return new gc(t)}static min(){return new gc(new pc(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function mc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function vc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class wc{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ja(),void 0===n?n=t.length-e:n>t.length-e&&Ja(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===wc.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof wc?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Ic extends wc{construct(t,e,n){return new Ic(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new tc(Za.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Ic(e)}static emptyPath(){return new Ic([])}}const bc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tc extends wc{construct(t,e,n){return new Tc(t,e,n)}static isValidIdentifier(t){return bc.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tc.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Tc(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new tc(Za.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new tc(Za.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new tc(Za.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new tc(Za.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Tc(e)}static emptyPath(){return new Tc([])}}class Ec{constructor(t){this.fields=t,t.sort(Tc.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return fc(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class _c{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new _c(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new _c(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return dc(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}_c.EMPTY_BYTE_STRING=new _c("");const Sc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kc(t){if(Qa(!!t),"string"==typeof t){let e=0;const n=Sc.exec(t);if(Qa(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ac(t.seconds),nanos:Ac(t.nanos)}}function Ac(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Cc(t){return"string"==typeof t?_c.fromBase64String(t):_c.fromUint8Array(t)}function Nc(t){const e=kc(t.mapValue.fields.__local_write_time__.timestampValue);return new pc(e.seconds,e.nanos)}class Oc{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Rc{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Rc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Rc&&t.projectId===this.projectId&&t.database===this.database}}function Dc(t){return null==t}function Pc(t){return 0===t&&1/t==-1/0}class Lc{constructor(t){this.path=t}static fromPath(t){return new Lc(Ic.fromString(t))}static fromName(t){return new Lc(Ic.fromString(t).popFirst(5))}static empty(){return new Lc(Ic.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ic.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ic.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Lc(new Ic(t.slice()))}}const Mc={mapValue:{fields:{__type__:{stringValue:"__max___"}}}};function xc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:10:Ja()}function Uc(t,e){if(t===e)return!0;const n=xc(t);if(n!==xc(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nc(t).isEqual(Nc(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=kc(t.timestampValue),i=kc(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Cc(t.bytesValue).isEqual(Cc(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ac(t.geoPointValue.latitude)===Ac(e.geoPointValue.latitude)&&Ac(t.geoPointValue.longitude)===Ac(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ac(t.integerValue)===Ac(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Ac(t.doubleValue),i=Ac(e.doubleValue);return n===i?Pc(n)===Pc(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return fc(t.arrayValue.values||[],e.arrayValue.values||[],Uc);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(mc(n)!==mc(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Uc(n[t],i[t])))return!1;return!0}(t,e);default:return Ja()}}function Vc(t,e){return void 0!==(t.values||[]).find((t=>Uc(t,e)))}function Fc(t,e){if(t===e)return 0;const n=xc(t),i=xc(e);if(n!==i)return dc(n,i);switch(n){case 0:return 0;case 1:return dc(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Ac(t.integerValue||t.doubleValue),i=Ac(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return jc(t.timestampValue,e.timestampValue);case 4:return jc(Nc(t),Nc(e));case 5:return dc(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Cc(t),i=Cc(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=dc(n[t],i[t]);if(0!==e)return e}return dc(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=dc(Ac(t.latitude),Ac(e.latitude));return 0!==n?n:dc(Ac(t.longitude),Ac(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Fc(n[t],i[t]);if(e)return e}return dc(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=dc(i[t],s[t]);if(0!==e)return e;const o=Fc(n[i[t]],r[s[t]]);if(0!==o)return o}return dc(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Ja()}}function jc(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return dc(t,e);const n=kc(t),i=kc(e),r=dc(n.seconds,i.seconds);return 0!==r?r:dc(n.nanos,i.nanos)}function Bc(t){return qc(t)}function qc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=kc(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Cc(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Lc.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=qc(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${qc(t.fields[r])}`;return n+"}"}(t.mapValue):Ja();var e,n}function $c(t){return!!t&&"integerValue"in t}function Hc(t){return!!t&&"arrayValue"in t}function Kc(t){return!!t&&"mapValue"in t}function Gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yc(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Gc(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gc(t.arrayValue.values[n]);return e}return Object.assign({},t)}class zc{constructor(t){this.value=t}static empty(){return new zc({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Kc(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Gc(e)}setAll(t){let e=Tc.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Gc(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Kc(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Uc(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Kc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){yc(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new zc(Gc(this.value))}}function Wc(t){const e=[];return yc(t.fields,((t,n)=>{const i=new Tc([t]);if(Kc(n)){const t=Wc(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Ec(e)}class Xc{constructor(t,e,n,i,r,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=r,this.documentState=s}static newInvalidDocument(t){return new Xc(t,0,gc.min(),gc.min(),zc.empty(),0)}static newFoundDocument(t,e,n){return new Xc(t,1,e,gc.min(),n,0)}static newNoDocument(t,e){return new Xc(t,2,e,gc.min(),zc.empty(),0)}static newUnknownDocument(t,e){return new Xc(t,3,e,gc.min(),zc.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=zc.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=zc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Xc&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Xc(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Jc{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.P=null}}function Qc(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Jc(t,e,n,i,r,s,o)}function Yc(t){const e=Ya(t);if(null===e.P){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Bc(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Dc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Bc(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Bc(t))).join(",")),e.P=t}return e.P}function Zc(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!hl(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Uc(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fl(t.startAt,e.startAt)&&fl(t.endAt,e.endAt)}class tl extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.v(t,e,n):new el(t,e,n):"array-contains"===e?new sl(t,n):"in"===e?new ol(t,n):"not-in"===e?new al(t,n):"array-contains-any"===e?new cl(t,n):new tl(t,e,n)}static v(t,e,n){return"in"===e?new nl(t,n):new il(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.V(Fc(e,this.value)):null!==e&&xc(this.value)===xc(e)&&this.V(Fc(e,this.value))}V(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ja()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class el extends tl{constructor(t,e,n){super(t,e,n),this.key=Lc.fromName(n.referenceValue)}matches(t){const e=Lc.comparator(t.key,this.key);return this.V(e)}}class nl extends tl{constructor(t,e){super(t,"in",e),this.keys=rl(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class il extends tl{constructor(t,e){super(t,"not-in",e),this.keys=rl(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function rl(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Lc.fromName(t.referenceValue)))}class sl extends tl{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Hc(e)&&Vc(e.arrayValue,this.value)}}class ol extends tl{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Vc(this.value.arrayValue,e)}}class al extends tl{constructor(t,e){super(t,"not-in",e)}matches(t){if(Vc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Vc(this.value.arrayValue,e)}}class cl extends tl{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Hc(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Vc(this.value.arrayValue,t)))}}class ll{constructor(t,e){this.position=t,this.inclusive=e}}class ul{constructor(t,e="asc"){this.field=t,this.dir=e}}function hl(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function dl(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Lc.comparator(Lc.fromName(o.referenceValue),n.key):Fc(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function fl(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Uc(t.position[n],e.position[n]))return!1;return!0}class pl{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.D=null,this.C=null,this.startAt,this.endAt}}function gl(t){const e=Ya(t);if(null===e.D){e.D=[];const t=function(t){for(const e of t.filters)if(e.S())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.D.push(new ul(t)),e.D.push(new ul(Tc.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.D.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new ul(Tc.keyField(),t))}}}return e.D}function ml(t){const e=Ya(t);if(!e.C)if("F"===e.limitType)e.C=Qc(e.path,e.collectionGroup,gl(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of gl(e)){const e="desc"===n.dir?"asc":"desc";t.push(new ul(n.field,e))}const n=e.endAt?new ll(e.endAt.position,!e.endAt.inclusive):null,i=e.startAt?new ll(e.startAt.position,!e.startAt.inclusive):null;e.C=Qc(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.C}function yl(t,e){return Zc(ml(t),ml(e))&&t.limitType===e.limitType}function vl(t){return`${Yc(ml(t))}|lt:${t.limitType}`}function wl(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Bc(e.value)}`;var e})).join(", ")}]`),Dc(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Bc(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Bc(t))).join(",")),`Target(${e})`}(ml(t))}; limitType=${t.limitType})`}function Il(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Lc.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=dl(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,gl(t),e)||t.endAt&&!function(t,e,n){const i=dl(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,gl(t),e))}(t,e)}function bl(t,e,n){const i=t.field.isKeyField()?Lc.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Fc(i,r):Ja()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ja()}}function Tl(t,e){if(t.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pc(e)?"-0":e}}function El(t){return{integerValue:""+t}}function _l(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Pc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?El(e):Tl(t,e)}class Sl{constructor(){this._=void 0}}function kl(t,e,n){return t instanceof Nl?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ol?Rl(t,e):t instanceof Dl?Pl(t,e):function(t,e){const n=Cl(t,e),i=Ml(n)+Ml(t.k);return $c(n)&&$c(t.k)?El(i):Tl(t.O,i)}(t,e)}function Al(t,e,n){return t instanceof Ol?Rl(t,e):t instanceof Dl?Pl(t,e):n}function Cl(t,e){return t instanceof Ll?$c(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Nl extends Sl{}class Ol extends Sl{constructor(t){super(),this.elements=t}}function Rl(t,e){const n=xl(e);for(const e of t.elements)n.some((t=>Uc(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Dl extends Sl{constructor(t){super(),this.elements=t}}function Pl(t,e){let n=xl(e);for(const e of t.elements)n=n.filter((t=>!Uc(t,e)));return{arrayValue:{values:n}}}class Ll extends Sl{constructor(t,e){super(),this.O=t,this.k=e}}function Ml(t){return Ac(t.integerValue||t.doubleValue)}function xl(t){return Hc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ul{constructor(t,e){this.version=t,this.transformResults=e}}class Vl{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Vl}static exists(t){return new Vl(void 0,t)}static updateTime(t){return new Vl(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Fl(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class jl{}function Bl(t,e,n){t instanceof Gl?function(t,e,n){const i=t.value.clone(),r=Xl(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof zl?function(t,e,n){if(!Fl(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Xl(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Wl(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ql(t,e,n){t instanceof Gl?function(t,e,n){if(!Fl(t.precondition,e))return;const i=t.value.clone(),r=Jl(t.fieldTransforms,n,e);i.setAll(r),e.convertToFoundDocument(Kl(e),i).setHasLocalMutations()}(t,e,n):t instanceof zl?function(t,e,n){if(!Fl(t.precondition,e))return;const i=Jl(t.fieldTransforms,n,e),r=e.data;r.setAll(Wl(t)),r.setAll(i),e.convertToFoundDocument(Kl(e),r).setHasLocalMutations()}(t,e,n):function(t,e){Fl(t.precondition,e)&&e.convertToNoDocument(gc.min())}(t,e)}function $l(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Cl(i.transform,t||null);null!=r&&(null==n&&(n=zc.empty()),n.set(i.field,r))}return n||null}function Hl(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&fc(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ol&&e instanceof Ol||t instanceof Dl&&e instanceof Dl?fc(t.elements,e.elements,Uc):t instanceof Ll&&e instanceof Ll?Uc(t.k,e.k):t instanceof Nl&&e instanceof Nl}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Kl(t){return t.isFoundDocument()?t.version:gc.min()}class Gl extends jl{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class zl extends jl{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}}function Wl(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Xl(t,e,n){const i=new Map;Qa(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Al(o,a,n[r]))}return i}function Jl(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,kl(t,s,e))}return i}class Ql extends jl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class Yl extends jl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}var Zl,tu;(tu=Zl||(Zl={}))[tu.OK=0]="OK",tu[tu.CANCELLED=1]="CANCELLED",tu[tu.UNKNOWN=2]="UNKNOWN",tu[tu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tu[tu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tu[tu.NOT_FOUND=5]="NOT_FOUND",tu[tu.ALREADY_EXISTS=6]="ALREADY_EXISTS",tu[tu.PERMISSION_DENIED=7]="PERMISSION_DENIED",tu[tu.UNAUTHENTICATED=16]="UNAUTHENTICATED",tu[tu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tu[tu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tu[tu.ABORTED=10]="ABORTED",tu[tu.OUT_OF_RANGE=11]="OUT_OF_RANGE",tu[tu.UNIMPLEMENTED=12]="UNIMPLEMENTED",tu[tu.INTERNAL=13]="INTERNAL",tu[tu.UNAVAILABLE=14]="UNAVAILABLE",tu[tu.DATA_LOSS=15]="DATA_LOSS";class eu{constructor(t,e){this.comparator=t,this.root=e||iu.EMPTY}insert(t,e){return new eu(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,iu.BLACK,null,null))}remove(t){return new eu(this.comparator,this.root.remove(t,this.comparator).copy(null,null,iu.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new nu(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new nu(this.root,t,this.comparator,!1)}getReverseIterator(){return new nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new nu(this.root,t,this.comparator,!0)}}class nu{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class iu{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:iu.RED,this.left=null!=i?i:iu.EMPTY,this.right=null!=r?r:iu.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new iu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return iu.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return iu.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,iu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,iu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ja();if(this.right.isRed())throw Ja();const t=this.left.check();if(t!==this.right.check())throw Ja();return t+(this.isRed()?0:1)}}iu.EMPTY=null,iu.RED=!0,iu.BLACK=!1,iu.EMPTY=new class{constructor(){this.size=0}get key(){throw Ja()}get value(){throw Ja()}get color(){throw Ja()}get left(){throw Ja()}get right(){throw Ja()}copy(t,e,n,i,r){return this}insert(t,e,n){return new iu(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ru{constructor(t){this.comparator=t,this.data=new eu(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new su(this.data.getIterator())}getIteratorFrom(t){return new su(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof ru))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ru(this.comparator);return e.data=t,e}}class su{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const ou=new eu(Lc.comparator);function au(){return ou}const cu=new eu(Lc.comparator);function lu(){return cu}const uu=new eu(Lc.comparator),hu=new ru(Lc.comparator);function du(...t){let e=hu;for(const n of t)e=e.add(n);return e}const fu=new ru(dc);class pu{constructor(t,e){this.databaseId=t,this.N=e}}function gu(t,e){return t.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mu(t,e){return t.N?e.toBase64():e.toUint8Array()}function yu(t,e){return gu(t,e.toTimestamp())}function vu(t){return Qa(!!t),gc.fromTimestamp(function(t){const e=kc(t);return new pc(e.seconds,e.nanos)}(t))}function wu(t,e){return function(t){return new Ic(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Iu(t,e){return wu(t.databaseId,e.path)}function bu(t){const e=function(t){const e=Ic.fromString(t);return Qa(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?Ic.emptyPath():function(t){return Qa(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Tu(t,e,n){return{name:Iu(t,e),fields:n.value.mapValue.fields}}function Eu(t){let e=bu(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Qa(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=_u(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new ul(Su(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Dc(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new ll(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new ll(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new pl(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,l)}function _u(t){return t?void 0!==t.unaryFilter?[Au(t)]:void 0!==t.fieldFilter?[ku(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>_u(t))).reduce(((t,e)=>t.concat(e))):Ja():[]}function Su(t){return Tc.fromServerFormat(t.fieldPath)}function ku(t){return tl.create(Su(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ja()}}(t.fieldFilter.op),t.fieldFilter.value)}function Au(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Su(t.unaryFilter.field);return tl.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Su(t.unaryFilter.field);return tl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Su(t.unaryFilter.field);return tl.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Su(t.unaryFilter.field);return tl.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Ja()}}function Cu(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Nu(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ru(e)),e=Ou(t.get(n),e);return Ru(e)}function Ou(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Ru(t){return t+""}class Du{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}Du.store="owner",Du.key="owner";class Pu{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}Pu.store="mutationQueues",Pu.keyPath="userId";class Lu{constructor(t,e,n,i,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=i,this.mutations=r}}Lu.store="mutations",Lu.keyPath="batchId",Lu.userMutationsIndex="userMutationsIndex",Lu.userMutationsKeyPath=["userId","batchId"];class Mu{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Nu(e)]}static key(t,e,n){return[t,Nu(e),n]}}Mu.store="documentMutations",Mu.PLACEHOLDER=new Mu;class xu{constructor(t,e,n,i,r,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=i,this.readTime=r,this.parentPath=s}}xu.store="remoteDocuments",xu.readTimeIndex="readTimeIndex",xu.readTimeIndexPath="readTime",xu.collectionReadTimeIndex="collectionReadTimeIndex",xu.collectionReadTimeIndexPath=["parentPath","readTime"];class Uu{constructor(t){this.byteSize=t}}Uu.store="remoteDocumentGlobal",Uu.key="remoteDocumentGlobalKey";class Vu{constructor(t,e,n,i,r,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=i,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=s,this.query=o}}Vu.store="targets",Vu.keyPath="targetId",Vu.queryTargetsIndexName="queryTargetsIndex",Vu.queryTargetsKeyPath=["canonicalId","targetId"];class Fu{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}Fu.store="targetDocuments",Fu.keyPath=["targetId","path"],Fu.documentTargetsIndex="documentTargetsIndex",Fu.documentTargetsKeyPath=["path","targetId"];class ju{constructor(t,e,n,i){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=i}}ju.key="targetGlobalKey",ju.store="targetGlobal";class Bu{constructor(t,e){this.collectionId=t,this.parent=e}}Bu.store="collectionParents",Bu.keyPath=["collectionId","parent"];class qu{constructor(t,e,n,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=i}}qu.store="clientMetadata",qu.keyPath="clientId";class $u{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}$u.store="bundles",$u.keyPath="bundleId";class Hu{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}Hu.store="namedQueries",Hu.keyPath="name";class Ku{constructor(t,e,n){this.indexId=t,this.collectionGroup=e,this.fields=n}}Ku.store="indexConfiguration",Ku.keyPath="indexId",Ku.collectionGroupIndex="collectionGroupIndex",Ku.collectionGroupIndexPath="collectionGroup";class Gu{constructor(t,e,n,i,r,s){this.indexId=t,this.uid=e,this.sequenceNumber=n,this.readTime=i,this.documentKey=r,this.largestBatchId=s}}Gu.store="indexState",Gu.keyPath=["indexId","uid"],Gu.sequenceNumberIndex="sequenceNumberIndex",Gu.sequenceNumberIndexPath=["uid","sequenceNumber"];class zu{constructor(t,e,n,i,r){this.indexId=t,this.uid=e,this.arrayValue=n,this.directionalValue=i,this.documentKey=r}}zu.store="indexEntries",zu.keyPath=["indexId","uid","arrayValue","directionalValue","documentKey"],zu.documentKeyIndex="documentKeyIndex",zu.documentKeyIndexPath=["indexId","uid","documentKey"];class Wu{constructor(t,e,n,i,r,s){this.userId=t,this.collectionPath=e,this.documentId=n,this.collectionGroup=i,this.largestBatchId=r,this.overlayMutation=s}}Wu.store="documentOverlays",Wu.keyPath=["userId","collectionPath","documentId"],Wu.collectionPathOverlayIndex="collectionPathOverlayIndex",Wu.collectionPathOverlayIndexPath=["userId","collectionPath","largestBatchId"],Wu.collectionGroupOverlayIndex="collectionGroupOverlayIndex",Wu.collectionGroupOverlayIndexPath=["userId","collectionGroup","largestBatchId"];Pu.store,Lu.store,Mu.store,xu.store,Vu.store,Du.store,ju.store,Fu.store,qu.store,Uu.store,Bu.store,$u.store,Hu.store,Wu.store;const Xu=(Ku.store,Gu.store,zu.store,"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.");class Ju{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ja(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Ju(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Ju?e:Ju.resolve(e)}catch(t){return Ju.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Ju.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Ju.reject(e)}static resolve(t){return new Ju(((e,n)=>{e(t)}))}static reject(t){return new Ju(((e,n)=>{n(t)}))}static waitFor(t){return new Ju(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Ju.resolve(!1);for(const n of t)e=e.next((t=>t?Ju.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function Qu(t){return"IndexedDbTransactionError"===t.name}class Yu{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Bl(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&ql(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&ql(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(gc.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),du())}isEqual(t){return this.batchId===t.batchId&&fc(this.mutations,t.mutations,((t,e)=>Hl(t,e)))&&fc(this.baseMutations,t.baseMutations,((t,e)=>Hl(t,e)))}}class Zu{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Qa(t.mutations.length===n.length);let i=uu;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new Zu(t,e,n,i)}}class th{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class eh{constructor(t){this.Ht=t}}function nh(t){const e=Eu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new pl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class ih{constructor(){}Xt(t,e){this.Zt(t,e),e.te()}Zt(t,e){if("nullValue"in t)this.ee(e,5);else if("booleanValue"in t)this.ee(e,10),e.ne(t.booleanValue?1:0);else if("integerValue"in t)this.ee(e,15),e.ne(Ac(t.integerValue));else if("doubleValue"in t){const n=Ac(t.doubleValue);isNaN(n)?this.ee(e,13):(this.ee(e,15),Pc(n)?e.ne(0):e.ne(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ee(e,20),"string"==typeof n?e.se(n):(e.se(`${n.seconds||""}`),e.ne(n.nanos||0))}else if("stringValue"in t)this.ie(t.stringValue,e),this.re(e);else if("bytesValue"in t)this.ee(e,30),e.oe(Cc(t.bytesValue)),this.re(e);else if("referenceValue"in t)this.ce(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ee(e,45),e.ne(n.latitude||0),e.ne(n.longitude||0)}else"mapValue"in t?Uc(t,Mc)?this.ee(e,Number.MAX_SAFE_INTEGER):(this.ue(t.mapValue,e),this.re(e)):"arrayValue"in t?(this.ae(t.arrayValue,e),this.re(e)):Ja()}ie(t,e){this.ee(e,25),this.he(t,e)}he(t,e){e.se(t)}ue(t,e){const n=t.fields||{};this.ee(e,55);for(const t of Object.keys(n))this.ie(t,e),this.Zt(n[t],e)}ae(t,e){const n=t.values||[];this.ee(e,50);for(const t of n)this.Zt(t,e)}ce(t,e){this.ee(e,37),Lc.fromName(t).path.forEach((t=>{this.ee(e,60),this.he(t,e)}))}ee(t,e){t.ne(e)}re(t){t.ne(2)}}ih.le=new ih;class rh{constructor(){this.xe=new sh}addToCollectionParentIndex(t,e){return this.xe.add(e),Ju.resolve()}getCollectionParents(t,e){return Ju.resolve(this.xe.getEntries(e))}addFieldIndex(t,e){return Ju.resolve()}deleteFieldIndex(t,e){return Ju.resolve()}getDocumentsMatchingTarget(t,e,n){return Ju.resolve(du())}getFieldIndex(t,e){return Ju.resolve(null)}getFieldIndexes(t,e){return Ju.resolve([])}getNextCollectionGroupToUpdate(t){return Ju.resolve(null)}updateCollectionGroup(t,e,n){return Ju.resolve()}updateIndexEntries(t,e){return Ju.resolve()}}class sh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new ru(Ic.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new ru(Ic.comparator)).toArray()}}class oh{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new oh(t,oh.DEFAULT_COLLECTION_PERCENTILE,oh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}oh.DEFAULT_COLLECTION_PERCENTILE=10,oh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oh.DEFAULT=new oh(41943040,oh.DEFAULT_COLLECTION_PERCENTILE,oh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oh.DISABLED=new oh(-1,0,0);class ah{constructor(t){this.ze=t}next(){return this.ze+=2,this.ze}static He(){return new ah(0)}static Je(){return new ah(-1)}}async function ch(t){if(t.code!==Za.FAILED_PRECONDITION||t.message!==Xu)throw t;Ga("LocalStore","Unexpectedly lost primary lease")}class lh{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0!==i){for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),!0;return!1}forEach(t){yc(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return vc(this.inner)}}class uh{constructor(t,e,n){this.qn=t,this.gs=e,this.indexManager=n}ys(t,e){return this.gs.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.ps(t,e,n)))}ps(t,e,n){return this.qn.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}Is(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}Es(t,e){return this.qn.getEntries(t,e).next((e=>this.Ts(t,e).next((()=>e))))}Ts(t,e){return this.gs.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.Is(e,t)))}As(t,e,n){return function(t){return Lc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Rs(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Ps(t,e,n):this.bs(t,e,n)}Rs(t,e){return this.ys(t,new Lc(e)).next((t=>{let e=lu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Ps(t,e,n){const i=e.collectionGroup;let r=lu();return this.indexManager.getCollectionParents(t,i).next((s=>Ju.forEach(s,(s=>{const o=function(t,e){return new pl(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.bs(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}bs(t,e,n){let i;return this.qn.getAll(t,e.path,n).next((n=>(i=n,this.gs.getAllMutationBatchesAffectingQuery(t,e)))).next((t=>{for(const e of t)for(const t of e.mutations){const n=t.key;let r=i.get(n);null==r&&(r=Xc.newInvalidDocument(n),i=i.insert(n,r)),ql(t,r,e.localWriteTime),r.isFoundDocument()||(i=i.remove(n))}})).next((()=>(i.forEach(((t,n)=>{Il(e,n)||(i=i.remove(t))})),i)))}}class hh{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.vs=n,this.Vs=i}static Ss(t,e){let n=du(),i=du();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new hh(t,e.fromCache,n,i)}}class dh{Ds(t){this.Cs=t}As(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(gc.min())?this.Ns(t,e):this.Cs.Es(t,i).next((r=>{const s=this.xs(e,r);return(function(t){return!Dc(t.limit)&&"F"===t.limitType}(e)||function(t){return!Dc(t.limit)&&"L"===t.limitType}(e))&&this.ks(e.limitType,s,i,n)?this.Ns(t,e):(Ka()<=N.DEBUG&&Ga("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),wl(e)),this.Cs.As(t,e,n).next((t=>(s.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}xs(t,e){let n=new ru(function(t){return(e,n)=>{let i=!1;for(const r of gl(t)){const t=bl(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{Il(t,i)&&(n=n.add(i))})),n}ks(t,e,n,i){if(n.size!==e.size)return!0;const r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ns(t,e){return Ka()<=N.DEBUG&&Ga("QueryEngine","Using full collection scan to execute query:",wl(e)),this.Cs.As(t,e,gc.min())}}class fh{constructor(t,e,n,i){this.persistence=t,this.Os=e,this.O=i,this.Ms=new eu(dc),this.$s=new lh((t=>Yc(t)),Zc),this.Fs=gc.min(),this.Bs=t.getRemoteDocumentCache(),this.Un=t.getTargetCache(),this.Kn=t.getBundleCache(),this.Ls(n)}Ls(t){this.indexManager=this.persistence.getIndexManager(t),this.gs=this.persistence.getMutationQueue(t,this.indexManager),this.Us=new uh(this.Bs,this.gs,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Os.Ds(this.Us)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}async function ph(t,e){const n=Ya(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.gs.getAllMutationBatches(t).next((r=>(i=r,n.Ls(e),n.gs.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=du();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.Us.Es(t,o).next((t=>({qs:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function gh(t,e){const n=Ya(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.gs.getNextMutationBatchAfterBatchId(t,e))))}class mh{constructor(t){this.O=t,this.Ws=new Map,this.zs=new Map}getBundleMetadata(t,e){return Ju.resolve(this.Ws.get(e))}saveBundleMetadata(t,e){var n;return this.Ws.set(e.id,{id:(n=e).id,version:n.version,createTime:vu(n.createTime)}),Ju.resolve()}getNamedQuery(t,e){return Ju.resolve(this.zs.get(e))}saveNamedQuery(t,e){return this.zs.set(e.name,function(t){return{name:t.name,query:nh(t.bundledQuery),readTime:vu(t.readTime)}}(e)),Ju.resolve()}}class yh{constructor(){this.overlays=new eu(Lc.comparator),this.Hs=new Map}getOverlay(t,e){return Ju.resolve(this.overlays.get(e))}saveOverlays(t,e,n){return n.forEach((n=>{this.Yt(t,e,n)})),Ju.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Hs.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Hs.delete(n)),Ju.resolve()}getOverlaysForCollection(t,e,n){const i=new Map,r=e.length+1,s=new Lc(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Ju.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new eu(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=new Map,r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=new Map,a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(e,t))),!(o.size>=i)););return Ju.resolve(o)}Yt(t,e,n){if(null===n)return;const i=this.overlays.get(n.key);null!==i&&this.Hs.get(i.largestBatchId).delete(n.key),this.overlays=this.overlays.insert(n.key,new th(e,n));let r=this.Hs.get(e);void 0===r&&(r=new Set,this.Hs.set(e,r)),r.add(n.key)}}class vh{constructor(){this.Js=new ru(wh.Ys),this.Xs=new ru(wh.Zs)}isEmpty(){return this.Js.isEmpty()}addReference(t,e){const n=new wh(t,e);this.Js=this.Js.add(n),this.Xs=this.Xs.add(n)}ti(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.ei(new wh(t,e))}ni(t,e){t.forEach((t=>this.removeReference(t,e)))}si(t){const e=new Lc(new Ic([])),n=new wh(e,t),i=new wh(e,t+1),r=[];return this.Xs.forEachInRange([n,i],(t=>{this.ei(t),r.push(t.key)})),r}ii(){this.Js.forEach((t=>this.ei(t)))}ei(t){this.Js=this.Js.delete(t),this.Xs=this.Xs.delete(t)}ri(t){const e=new Lc(new Ic([])),n=new wh(e,t),i=new wh(e,t+1);let r=du();return this.Xs.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new wh(t,0),n=this.Js.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class wh{constructor(t,e){this.key=t,this.oi=e}static Ys(t,e){return Lc.comparator(t.key,e.key)||dc(t.oi,e.oi)}static Zs(t,e){return dc(t.oi,e.oi)||Lc.comparator(t.key,e.key)}}class Ih{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.gs=[],this.ci=1,this.ui=new ru(wh.Ys)}checkEmpty(t){return Ju.resolve(0===this.gs.length)}addMutationBatch(t,e,n,i){const r=this.ci;this.ci++,this.gs.length>0&&this.gs[this.gs.length-1];const s=new Yu(r,e,n,i);this.gs.push(s);for(const e of i)this.ui=this.ui.add(new wh(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Ju.resolve(s)}lookupMutationBatch(t,e){return Ju.resolve(this.ai(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.hi(n),r=i<0?0:i;return Ju.resolve(this.gs.length>r?this.gs[r]:null)}getHighestUnacknowledgedBatchId(){return Ju.resolve(0===this.gs.length?-1:this.ci-1)}getAllMutationBatches(t){return Ju.resolve(this.gs.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new wh(e,0),i=new wh(e,Number.POSITIVE_INFINITY),r=[];return this.ui.forEachInRange([n,i],(t=>{const e=this.ai(t.oi);r.push(e)})),Ju.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ru(dc);return e.forEach((t=>{const e=new wh(t,0),i=new wh(t,Number.POSITIVE_INFINITY);this.ui.forEachInRange([e,i],(t=>{n=n.add(t.oi)}))})),Ju.resolve(this.li(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Lc.isDocumentKey(r)||(r=r.child(""));const s=new wh(new Lc(r),0);let o=new ru(dc);return this.ui.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.oi)),!0)}),s),Ju.resolve(this.li(o))}li(t){const e=[];return t.forEach((t=>{const n=this.ai(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Qa(0===this.fi(e.batchId,"removed")),this.gs.shift();let n=this.ui;return Ju.forEach(e.mutations,(i=>{const r=new wh(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.ui=n}))}Qe(t){}containsKey(t,e){const n=new wh(e,0),i=this.ui.firstAfterOrEqual(n);return Ju.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.gs.length,Ju.resolve()}fi(t,e){return this.hi(t)}hi(t){return 0===this.gs.length?0:t-this.gs[0].batchId}ai(t){const e=this.hi(t);return e<0||e>=this.gs.length?null:this.gs[e]}}class bh{constructor(t){this.di=t,this.docs=new eu(Lc.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.di(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Ju.resolve(n?n.document.mutableCopy():Xc.newInvalidDocument(e))}getEntries(t,e){let n=au();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Xc.newInvalidDocument(t))})),Ju.resolve(n)}getAll(t,e,n){let i=au();const r=new Lc(e.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r}}=s.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||r.readTime.compareTo(n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return Ju.resolve(i)}_i(t,e){return Ju.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Th(this)}getSize(t){return Ju.resolve(this.size)}}class Th extends class{constructor(){this.changes=new lh((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Xc.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Ju.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Tn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Tn.addEntry(t,i)):this.Tn.removeEntry(n)})),Ju.waitFor(e)}getFromCache(t,e){return this.Tn.getEntry(t,e)}getAllFromCache(t,e){return this.Tn.getEntries(t,e)}}class Eh{constructor(t){this.persistence=t,this.wi=new lh((t=>Yc(t)),Zc),this.lastRemoteSnapshotVersion=gc.min(),this.highestTargetId=0,this.mi=0,this.gi=new vh,this.targetCount=0,this.yi=ah.He()}forEachTarget(t,e){return this.wi.forEach(((t,n)=>e(n))),Ju.resolve()}getLastRemoteSnapshotVersion(t){return Ju.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ju.resolve(this.mi)}allocateTargetId(t){return this.highestTargetId=this.yi.next(),Ju.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.mi&&(this.mi=e),Ju.resolve()}Ze(t){this.wi.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.yi=new ah(e),this.highestTargetId=e),t.sequenceNumber>this.mi&&(this.mi=t.sequenceNumber)}addTargetData(t,e){return this.Ze(e),this.targetCount+=1,Ju.resolve()}updateTargetData(t,e){return this.Ze(e),Ju.resolve()}removeTargetData(t,e){return this.wi.delete(e.target),this.gi.si(e.targetId),this.targetCount-=1,Ju.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.wi.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.wi.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Ju.waitFor(r).next((()=>i))}getTargetCount(t){return Ju.resolve(this.targetCount)}getTargetData(t,e){const n=this.wi.get(e)||null;return Ju.resolve(n)}addMatchingKeys(t,e,n){return this.gi.ti(e,n),Ju.resolve()}removeMatchingKeys(t,e,n){this.gi.ni(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Ju.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.gi.si(e),Ju.resolve()}getMatchingKeysForTargetId(t,e){const n=this.gi.ri(e);return Ju.resolve(n)}containsKey(t,e){return Ju.resolve(this.gi.containsKey(e))}}class _h{constructor(t,e){this.pi={},this.overlays={},this.Nn=new lc(0),this.xn=!1,this.xn=!0,this.referenceDelegate=t(this),this.Un=new Eh(this),this.indexManager=new rh,this.qn=function(t){return new bh(t)}((t=>this.referenceDelegate.Ii(t))),this.O=new eh(e),this.Kn=new mh(this.O)}start(){return Promise.resolve()}shutdown(){return this.xn=!1,Promise.resolve()}get started(){return this.xn}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new yh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.pi[t.toKey()];return n||(n=new Ih(e,this.referenceDelegate),this.pi[t.toKey()]=n),n}getTargetCache(){return this.Un}getRemoteDocumentCache(){return this.qn}getBundleCache(){return this.Kn}runTransaction(t,e,n){Ga("MemoryPersistence","Starting transaction:",t);const i=new Sh(this.Nn.next());return this.referenceDelegate.Ei(),n(i).next((t=>this.referenceDelegate.Ti(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ai(t,e){return Ju.or(Object.values(this.pi).map((n=>()=>n.containsKey(t,e))))}}class Sh extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class kh{constructor(t){this.persistence=t,this.Ri=new vh,this.Pi=null}static bi(t){return new kh(t)}get vi(){if(this.Pi)return this.Pi;throw Ja()}addReference(t,e,n){return this.Ri.addReference(n,e),this.vi.delete(n.toString()),Ju.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.vi.add(n.toString()),Ju.resolve()}markPotentiallyOrphaned(t,e){return this.vi.add(e.toString()),Ju.resolve()}removeTarget(t,e){this.Ri.si(e.targetId).forEach((t=>this.vi.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.vi.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Pi=new Set}Ti(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ju.forEach(this.vi,(n=>{const i=Lc.fromPath(n);return this.Vi(t,i).next((t=>{t||e.removeEntry(i,gc.min())}))})).next((()=>(this.Pi=null,e.apply(t))))}updateLimboDocument(t,e){return this.Vi(t,e).next((t=>{t?this.vi.delete(e.toString()):this.vi.add(e.toString())}))}Ii(t){return 0}Vi(t,e){return Ju.or([()=>Ju.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Ah{constructor(){this.activeTargetIds=fu}Ci(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ni(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Di(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ch{constructor(){this._r=new Ah,this.wr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this._r.Ci(t),this.wr[t]||"not-current"}updateQueryState(t,e,n){this.wr[t]=e}removeLocalQueryTarget(t){this._r.Ni(t)}isLocalQueryTarget(t){return this._r.activeTargetIds.has(t)}clearQueryState(t){delete this.wr[t]}getAllActiveQueryTargets(){return this._r.activeTargetIds}isActiveQueryTarget(t){return this._r.activeTargetIds.has(t)}start(){return this._r=new Ah,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class Nh{mr(t){}shutdown(){}}class Oh{constructor(){this.gr=()=>this.yr(),this.pr=()=>this.Ir(),this.Er=[],this.Tr()}mr(t){this.Er.push(t)}shutdown(){window.removeEventListener("online",this.gr),window.removeEventListener("offline",this.pr)}Tr(){window.addEventListener("online",this.gr),window.addEventListener("offline",this.pr)}yr(){Ga("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Er)t(0)}Ir(){Ga("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Er)t(1)}static Vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Rh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Dh{constructor(t){this.Ar=t.Ar,this.Rr=t.Rr}Pr(t){this.br=t}vr(t){this.Vr=t}onMessage(t){this.Sr=t}close(){this.Rr()}send(t){this.Ar(t)}Dr(){this.br()}Cr(t){this.Vr(t)}Nr(t){this.Sr(t)}}class Ph extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.kr=e+"://"+t.host,this.Or="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Mr(t,e,n,i,r){const s=this.$r(t,e);Ga("RestConnection","Sending: ",s,n);const o={};return this.Fr(o,i,r),this.Br(t,s,o,n).then((t=>(Ga("RestConnection","Received: ",t),t)),(e=>{throw Wa("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e}))}Lr(t,e,n,i,r){return this.Mr(t,e,n,i,r)}Fr(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+$a,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}$r(t,e){const n=Rh[t];return`${this.kr}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}Br(t,e,n,i){return new Promise(((r,s)=>{const o=new ja;o.listenOnce(Ma.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case La.NO_ERROR:const e=o.getResponseJson();Ga("Connection","XHR received:",JSON.stringify(e)),r(e);break;case La.TIMEOUT:Ga("Connection",'RPC "'+t+'" timed out'),s(new tc(Za.DEADLINE_EXCEEDED,"Request time out"));break;case La.HTTP_ERROR:const n=o.getStatus();if(Ga("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Za).indexOf(e)>=0?e:Za.UNKNOWN}(t.status);s(new tc(e,t.message))}else s(new tc(Za.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new tc(Za.UNAVAILABLE,"Connection failed."));break;default:Ja()}}finally{Ga("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}Ur(t,e,n){const i=[this.kr,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Da(),u=Pa(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new Va({})),this.Fr(h.initMessageHeaders,e,n),o()||c()||s().indexOf("Electron/")>=0||l()||s().indexOf("MSAppHost/")>=0||a()||(h.httpHeadersOverwriteParam="$httpHeaders");const d=i.join("");Ga("Connection","Creating WebChannel: "+d,h);const f=r.createWebChannel(d,h);let p=!1,g=!1;const m=new Dh({Ar:t=>{g?Ga("Connection","Not sending because WebChannel is closed:",t):(p||(Ga("Connection","Opening WebChannel transport."),f.open(),p=!0),Ga("Connection","WebChannel sending:",t),f.send(t))},Rr:()=>f.close()}),y=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return y(f,Fa.EventType.OPEN,(()=>{g||Ga("Connection","WebChannel transport opened.")})),y(f,Fa.EventType.CLOSE,(()=>{g||(g=!0,Ga("Connection","WebChannel transport closed"),m.Cr())})),y(f,Fa.EventType.ERROR,(t=>{g||(g=!0,Wa("Connection","WebChannel transport errored:",t),m.Cr(new tc(Za.UNAVAILABLE,"The operation could not be completed")))})),y(f,Fa.EventType.MESSAGE,(t=>{var e;if(!g){const n=t.data[0];Qa(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){Ga("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=Zl[t];if(void 0!==e)return function(t){if(void 0===t)return za("GRPC error has no .code"),Za.UNKNOWN;switch(t){case Zl.OK:return Za.OK;case Zl.CANCELLED:return Za.CANCELLED;case Zl.UNKNOWN:return Za.UNKNOWN;case Zl.DEADLINE_EXCEEDED:return Za.DEADLINE_EXCEEDED;case Zl.RESOURCE_EXHAUSTED:return Za.RESOURCE_EXHAUSTED;case Zl.INTERNAL:return Za.INTERNAL;case Zl.UNAVAILABLE:return Za.UNAVAILABLE;case Zl.UNAUTHENTICATED:return Za.UNAUTHENTICATED;case Zl.INVALID_ARGUMENT:return Za.INVALID_ARGUMENT;case Zl.NOT_FOUND:return Za.NOT_FOUND;case Zl.ALREADY_EXISTS:return Za.ALREADY_EXISTS;case Zl.PERMISSION_DENIED:return Za.PERMISSION_DENIED;case Zl.FAILED_PRECONDITION:return Za.FAILED_PRECONDITION;case Zl.ABORTED:return Za.ABORTED;case Zl.OUT_OF_RANGE:return Za.OUT_OF_RANGE;case Zl.UNIMPLEMENTED:return Za.UNIMPLEMENTED;case Zl.DATA_LOSS:return Za.DATA_LOSS;default:return Ja()}}(e)}(t),n=r.message;void 0===e&&(e=Za.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),g=!0,m.Cr(new tc(e,n)),f.close()}else Ga("Connection","WebChannel received:",n),m.Nr(n)}})),y(u,xa.STAT_EVENT,(t=>{t.stat===Ua.PROXY?Ga("Connection","Detected buffering proxy"):t.stat===Ua.NOPROXY&&Ga("Connection","Detected no buffering proxy")})),setTimeout((()=>{m.Dr()}),0),m}}function Lh(){return"undefined"!=typeof document?document:null}function Mh(t){return new pu(t,!0)}class xh{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Sn=t,this.timerId=e,this.qr=n,this.Kr=i,this.Gr=r,this.jr=0,this.Qr=null,this.Wr=Date.now(),this.reset()}reset(){this.jr=0}zr(){this.jr=this.Gr}Hr(t){this.cancel();const e=Math.floor(this.jr+this.Jr()),n=Math.max(0,Date.now()-this.Wr),i=Math.max(0,e-n);i>0&&Ga("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.jr} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Qr=this.Sn.enqueueAfterDelay(this.timerId,i,(()=>(this.Wr=Date.now(),t()))),this.jr*=this.Kr,this.jr<this.qr&&(this.jr=this.qr),this.jr>this.Gr&&(this.jr=this.Gr)}Yr(){null!==this.Qr&&(this.Qr.skipDelay(),this.Qr=null)}cancel(){null!==this.Qr&&(this.Qr.cancel(),this.Qr=null)}Jr(){return(Math.random()-.5)*this.jr}}class Uh extends class{constructor(t,e,n,i,r,s,o,a){this.Sn=t,this.Xr=n,this.Zr=i,this.eo=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.no=0,this.so=null,this.io=null,this.stream=null,this.ro=new xh(t,e)}oo(){return 1===this.state||5===this.state||this.co()}co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.uo()}async stop(){this.oo()&&await this.close(0)}ao(){this.state=0,this.ro.reset()}ho(){this.co()&&null===this.so&&(this.so=this.Sn.enqueueAfterDelay(this.Xr,6e4,(()=>this.lo())))}fo(t){this._o(),this.stream.send(t)}async lo(){if(this.co())return this.close(0)}_o(){this.so&&(this.so.cancel(),this.so=null)}wo(){this.io&&(this.io.cancel(),this.io=null)}async close(t,e){this._o(),this.wo(),this.ro.cancel(),this.no++,4!==t?this.ro.reset():e&&e.code===Za.RESOURCE_EXHAUSTED?(za(e.toString()),za("Using maximum backoff delay to prevent overloading the backend."),this.ro.zr()):e&&e.code===Za.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.mo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.vr(e)}mo(){}auth(){this.state=1;const t=this.yo(this.no),e=this.no;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.no===e&&this.po(t,n)}),(e=>{t((()=>{const t=new tc(Za.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Io(t)}))}))}po(t,e){const n=this.yo(this.no);this.stream=this.Eo(t,e),this.stream.Pr((()=>{n((()=>(this.state=2,this.io=this.Sn.enqueueAfterDelay(this.Zr,1e4,(()=>(this.co()&&(this.state=3),Promise.resolve()))),this.listener.Pr())))})),this.stream.vr((t=>{n((()=>this.Io(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}uo(){this.state=5,this.ro.Hr((async()=>{this.state=0,this.start()}))}Io(t){return Ga("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}yo(t){return e=>{this.Sn.enqueueAndForget((()=>this.no===t?e():(Ga("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.O=r,this.Po=!1}get bo(){return this.Po}start(){this.Po=!1,this.lastStreamToken=void 0,super.start()}mo(){this.Po&&this.vo([])}Eo(t,e){return this.eo.Ur("Write",t,e)}onMessage(t){if(Qa(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Po){this.ro.reset();const e=function(t,e){return t&&t.length>0?(Qa(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?vu(t.updateTime):vu(e);return n.isEqual(gc.min())&&(n=vu(e)),new Ul(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=vu(t.commitTime);return this.listener.Vo(n,e)}return Qa(!t.writeResults||0===t.writeResults.length),this.Po=!0,this.listener.So()}Do(){const t={};t.database=function(t){return new Ic(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.O),this.fo(t)}vo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Gl)n={update:Tu(t,e.key,e.value)};else if(e instanceof Ql)n={delete:Iu(t,e.key)};else if(e instanceof zl)n={update:Tu(t,e.key,e.data),updateMask:Cu(e.fieldMask)};else{if(!(e instanceof Yl))return Ja();n={verify:Iu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Nl)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ol)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Dl)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ll)return{fieldPath:e.field.canonicalString(),increment:n.k};throw Ja()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:yu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ja()}(t,e.precondition)),n}(this.O,t)))};this.fo(e)}}class Vh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.eo=n,this.O=i,this.Co=!1}No(){if(this.Co)throw new tc(Za.FAILED_PRECONDITION,"The client has already been terminated.")}Mr(t,e,n){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.eo.Mr(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Za.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new tc(Za.UNKNOWN,t.toString())}))}Lr(t,e,n){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.eo.Lr(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Za.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new tc(Za.UNKNOWN,t.toString())}))}terminate(){this.Co=!0}}class Fh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}Mo(){0===this.xo&&(this.$o("Unknown"),this.ko=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ko=null,this.Fo("Backend didn't respond within 10 seconds."),this.$o("Offline"),Promise.resolve()))))}Bo(t){"Online"===this.state?this.$o("Unknown"):(this.xo++,this.xo>=1&&(this.Lo(),this.Fo(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.$o("Offline")))}set(t){this.Lo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.$o(t)}$o(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Fo(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Oo?(za(e),this.Oo=!1):Ga("OnlineStateTracker",e)}Lo(){null!==this.ko&&(this.ko.cancel(),this.ko=null)}}class jh{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Uo=[],this.qo=new Map,this.Ko=new Set,this.Go=[],this.jo=r,this.jo.mr((t=>{n.enqueueAndForget((async()=>{$h(this)&&(Ga("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Ya(t);e.Ko.add(4),await qh(e),e.Qo.set("Unknown"),e.Ko.delete(4),await Bh(e)}(this))}))})),this.Qo=new Fh(n,i)}}async function Bh(t){if($h(t))for(const e of t.Go)await e(!0)}async function qh(t){for(const e of t.Go)await e(!1)}function $h(t){return 0===Ya(t).Ko.size}async function Hh(t,e,n){if(!Qu(e))throw e;t.Ko.add(1),await qh(t),t.Qo.set("Offline"),n||(n=()=>function(t){const e=Ya(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Un.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ga("RemoteStore","Retrying IndexedDB access"),await n(),t.Ko.delete(1),await Bh(t)}))}function Kh(t,e){return e().catch((n=>Hh(t,n,e)))}async function Gh(t){const e=Ya(t),n=nd(e);let i=e.Uo.length>0?e.Uo[e.Uo.length-1].batchId:-1;for(;zh(e);)try{const t=await gh(e.localStore,i);if(null===t){0===e.Uo.length&&n.ho();break}i=t.batchId,Wh(e,t)}catch(t){await Hh(e,t)}Xh(e)&&Jh(e)}function zh(t){return $h(t)&&t.Uo.length<10}function Wh(t,e){t.Uo.push(e);const n=nd(t);n.co()&&n.bo&&n.vo(e.mutations)}function Xh(t){return $h(t)&&!nd(t).oo()&&t.Uo.length>0}function Jh(t){nd(t).start()}async function Qh(t){nd(t).Do()}async function Yh(t){const e=nd(t);for(const n of t.Uo)e.vo(n.mutations)}async function Zh(t,e,n){const i=t.Uo.shift(),r=Zu.from(i,e,n);await Kh(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await Gh(t)}async function td(t,e){e&&nd(t).bo&&await async function(t,e){if(function(t){switch(t){default:return Ja();case Za.CANCELLED:case Za.UNKNOWN:case Za.DEADLINE_EXCEEDED:case Za.RESOURCE_EXHAUSTED:case Za.INTERNAL:case Za.UNAVAILABLE:case Za.UNAUTHENTICATED:return!1;case Za.INVALID_ARGUMENT:case Za.NOT_FOUND:case Za.ALREADY_EXISTS:case Za.PERMISSION_DENIED:case Za.FAILED_PRECONDITION:case Za.ABORTED:case Za.OUT_OF_RANGE:case Za.UNIMPLEMENTED:case Za.DATA_LOSS:return!0}}(n=e.code)&&n!==Za.ABORTED){const n=t.Uo.shift();nd(t).ao(),await Kh(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Gh(t)}var n}(t,e),Xh(t)&&Jh(t)}async function ed(t,e){const n=Ya(t);n.asyncQueue.verifyOperationInProgress(),Ga("RemoteStore","RemoteStore received new credentials");const i=$h(n);n.Ko.add(3),await qh(n),i&&n.Qo.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ko.delete(3),await Bh(n)}function nd(t){return t.Ho||(t.Ho=function(t,e,n){const i=Ya(t);return i.No(),new Uh(e,i.eo,i.authCredentials,i.appCheckCredentials,i.O,n)}(t.datastore,t.asyncQueue,{Pr:Qh.bind(null,t),vr:td.bind(null,t),So:Yh.bind(null,t),Vo:Zh.bind(null,t)}),t.Go.push((async e=>{e?(t.Ho.ao(),await Gh(t)):(await t.Ho.stop(),t.Uo.length>0&&(Ga("RemoteStore",`Stopping write stream with ${t.Uo.length} pending writes`),t.Uo=[]))}))),t.Ho}class id{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new ec,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new id(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tc(Za.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rd(t,e){if(za("AsyncQueue",`${e}: ${t}`),Qu(t))return new tc(Za.UNAVAILABLE,`${e}: ${t}`);throw t}class sd{constructor(){this.queries=new lh((t=>vl(t)),yl),this.onlineState="Unknown",this.Zo=new Set}}class od{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Dc={},this.Cc=new lh((t=>vl(t)),yl),this.Nc=new Map,this.xc=new Set,this.kc=new eu(Lc.comparator),this.Oc=new Map,this.Mc=new vh,this.$c={},this.Fc=new Map,this.Bc=ah.Je(),this.onlineState="Unknown",this.Lc=void 0}get isPrimaryClient(){return!0===this.Lc}}function ad(t,e,n){const i=Ya(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.Cc.forEach(((n,i)=>{const r=i.view.tc(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Ya(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.tc(e)&&(i=!0)})),i&&function(t){t.Zo.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.Dc.To(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cd(t,e){const n=Ya(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Ya(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.Bs.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Ju.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Qa(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.gs.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.gs.performConsistencyCheck(t))).next((()=>n.Us.Es(t,i)))}))}(n.localStore,e);hd(n,i,null),ud(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await dd(n,t)}catch(t){await ch(t)}}async function ld(t,e,n){const i=Ya(t);try{const t=await function(t,e){const n=Ya(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.gs.lookupMutationBatch(t,e).next((e=>(Qa(null!==e),i=e.keys(),n.gs.removeMutationBatch(t,e)))).next((()=>n.gs.performConsistencyCheck(t))).next((()=>n.Us.Es(t,i)))}))}(i.localStore,e);hd(i,e,n),ud(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await dd(i,t)}catch(n){await ch(n)}}function ud(t,e){(t.Fc.get(e)||[]).forEach((t=>{t.resolve()})),t.Fc.delete(e)}function hd(t,e,n){const i=Ya(t);let r=i.$c[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.$c[i.currentUser.toKey()]=r}}async function dd(t,e,n){const i=Ya(t),r=[],s=[],o=[];i.Cc.isEmpty()||(i.Cc.forEach(((t,a)=>{o.push(i.Uc(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=hh.Ss(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.Dc.To(r),await async function(t,e){const n=Ya(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Ju.forEach(e,(e=>Ju.forEach(e.vs,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Ju.forEach(e.Vs,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Qu(t))throw t;Ga("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ms.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Ms=n.Ms.insert(e,r)}}}(i.localStore,s))}async function fd(t,e){const n=Ya(t);if(!n.currentUser.isEqual(e)){Ga("SyncEngine","User change. New user:",e.toKey());const t=await ph(n.localStore,e);n.currentUser=e,function(t,e){t.Fc.forEach((t=>{t.forEach((t=>{t.reject(new tc(Za.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await dd(n,t.qs)}}function pd(t){const e=Ya(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cd.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ld.bind(null,e),e}class gd{constructor(){this.synchronizeTabs=!1}async initialize(t){this.O=Mh(t.databaseInfo.databaseId),this.sharedClientState=this.Gc(t),this.persistence=this.jc(t),await this.persistence.start(),this.gcScheduler=this.Qc(t),this.localStore=this.Wc(t)}Qc(t){return null}Wc(t){return function(t,e,n,i){return new fh(t,e,n,i)}(this.persistence,new dh,t.initialUser,this.O)}jc(t){return new _h(kh.bi,this.O)}Gc(t){return new Ch}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class md{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>ad(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=fd.bind(null,this.syncEngine),await async function(t,e){const n=Ya(t);e?(n.Ko.delete(2),await Bh(n)):e||(n.Ko.add(2),await qh(n),n.Qo.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new sd}createDatastore(t){const e=Mh(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Ph(i));var i;return function(t,e,n,i){return new Vh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>ad(this.syncEngine,t,0),s=Oh.Vt()?new Oh:new Nh,new jh(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new od(t,e,n,i,r,s);return o&&(a.Lc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Ya(t);Ga("RemoteStore","RemoteStore shutting down."),e.Ko.add(5),await qh(e),e.jo.shutdown(),e.Qo.set("Unknown")}(this.remoteStore)}}class yd{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=qa.UNAUTHENTICATED,this.clientId=hc.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ga("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ga("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new tc(Za.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ec;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=rd(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function vd(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Ga("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Ga("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await ph(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new gd)),t.offlineComponents}(t);Ga("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>ed(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>ed(e.remoteStore,n))),t.onlineComponents=e}function wd(t){return async function(t){return t.onlineComponents||(Ga("FirestoreClient","Using default OnlineComponentProvider"),await vd(t,new md)),t.onlineComponents}(t).then((t=>t.syncEngine))}const Id=new Map;function bd(t,e,n){if(!n)throw new tc(Za.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Td(t){if(!Lc.isDocumentKey(t))throw new tc(Za.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ed(t){if(Lc.isDocumentKey(t))throw new tc(Za.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function _d(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ja()}class Sd{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new tc(Za.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new tc(Za.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new tc(Za.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class kd{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sd({}),this._settingsFrozen=!1,t instanceof Rc?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new tc(Za.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rc(t.options.projectId)}(t))}get app(){if(!this._app)throw new tc(Za.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new tc(Za.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sd(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new ic;switch(t.type){case"gapi":const e=t.client;return Qa(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new oc(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new tc(Za.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Id.get(t);e&&(Ga("ComponentProvider","Removing Datastore"),Id.delete(t),e.terminate())}(this),Promise.resolve()}}class Ad{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ad(this.firestore,t,this._key)}}class Cd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Cd(this.firestore,t,this._query)}}class Nd extends Cd{constructor(t,e,n){super(t,e,function(t){return new pl(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ad(this.firestore,null,new Lc(t))}withConverter(t){return new Nd(this.firestore,t,this._path)}}class Od{constructor(){this.hu=Promise.resolve(),this.lu=[],this.fu=!1,this.du=[],this._u=null,this.wu=!1,this.mu=!1,this.gu=[],this.ro=new xh(this,"async_queue_retry"),this.yu=()=>{const t=Lh();t&&Ga("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ro.Yr()};const t=Lh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.yu)}get isShuttingDown(){return this.fu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.pu(),this.Iu(t)}enterRestrictedMode(t){if(!this.fu){this.fu=!0,this.mu=t||!1;const e=Lh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.yu)}}enqueue(t){if(this.pu(),this.fu)return new Promise((()=>{}));const e=new ec;return this.Iu((()=>this.fu&&this.mu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.lu.push(t),this.Eu())))}async Eu(){if(0!==this.lu.length){try{await this.lu[0](),this.lu.shift(),this.ro.reset()}catch(t){if(!Qu(t))throw t;Ga("AsyncQueue","Operation failed with retryable error: "+t)}this.lu.length>0&&this.ro.Hr((()=>this.Eu()))}}Iu(t){const e=this.hu.then((()=>(this.wu=!0,t().catch((t=>{this._u=t,this.wu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw za("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.wu=!1,t))))));return this.hu=e,e}enqueueAfterDelay(t,e,n){this.pu(),this.gu.indexOf(t)>-1&&(e=0);const i=id.createAndSchedule(this,t,e,n,(t=>this.Tu(t)));return this.du.push(i),i}pu(){this._u&&Ja()}verifyOperationInProgress(){}async Au(){let t;do{t=this.hu,await t}while(t!==this.hu)}Ru(t){for(const e of this.du)if(e.timerId===t)return!0;return!1}Pu(t){return this.Au().then((()=>{this.du.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.du)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Au()}))}bu(t){this.gu.push(t)}Tu(t){const e=this.du.indexOf(t);this.du.splice(e,1)}}class Rd extends kd{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new Od,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Dd(this),this._firestoreClient.terminate()}}function Dd(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Oc(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new yd(t._authCredentials,t._appCheckCredentials,t._queue,i)}class Pd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new tc(Za.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tc(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ld{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ld(_c.fromBase64String(t))}catch(t){throw new tc(Za.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ld(_c.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Md{constructor(t){this._methodName=t}}class xd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new tc(Za.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new tc(Za.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return dc(this._lat,t._lat)||dc(this._long,t._long)}}const Ud=/^__.*__$/;class Vd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new zl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Gl(t,this.data,e,this.fieldTransforms)}}function Fd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ja()}}class jd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.O=n,this.ignoreUndefinedProperties=i,void 0===r&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}Su(t){return new jd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.O,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Du(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Su({path:n,Cu:!1});return i.Nu(t),i}xu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Su({path:n,Cu:!1});return i.vu(),i}ku(t){return this.Su({path:void 0,Cu:!0})}Ou(t){return Jd(t,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.$u)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Nu(this.path.get(t))}Nu(t){if(0===t.length)throw this.Ou("Document fields must not be empty");if(Fd(this.Vu)&&Ud.test(t))throw this.Ou('Document fields cannot begin and end with "__"')}}class Bd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.O=n||Mh(t)}Fu(t,e,n,i=!1){return new jd({Vu:t,methodName:e,$u:n,path:Tc.emptyPath(),Cu:!1,Mu:i},this.databaseId,this.O,this.ignoreUndefinedProperties)}}function qd(t){const e=t._freezeSettings(),n=Mh(t._databaseId);return new Bd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $d(t,e,n,i,r,s={}){const o=t.Fu(s.merge||s.mergeFields?2:0,e,n,r);zd("Data must be an object, but it was:",o,i);const a=Kd(i,o);let c,l;if(s.merge)c=new Ec(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=Wd(e,i,n);if(!o.contains(r))throw new tc(Za.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Qd(t,r)||t.push(r)}c=new Ec(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new Vd(new zc(a),c,l)}function Hd(t,e){if(Gd(t=E(t)))return zd("Unsupported field value:",e,t),Kd(t,e);if(t instanceof Md)return function(t,e){if(!Fd(e.Vu))throw e.Ou(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Ou(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Cu&&4!==e.Vu)throw e.Ou("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Hd(r,e.ku(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=E(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return _l(e.O,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=pc.fromDate(t);return{timestampValue:gu(e.O,n)}}if(t instanceof pc){const n=new pc(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:gu(e.O,n)}}if(t instanceof xd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ld)return{bytesValue:mu(e.O,t._byteString)};if(t instanceof Ad){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Ou(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:wu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Ou(`Unsupported field value: ${_d(t)}`)}(t,e)}function Kd(t,e){const n={};return vc(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yc(t,((t,i)=>{const r=Hd(i,e.Du(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Gd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof pc||t instanceof xd||t instanceof Ld||t instanceof Ad||t instanceof Md)}function zd(t,e,n){if(!Gd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=_d(n);throw"an object"===i?e.Ou(t+" a custom object"):e.Ou(t+" "+i)}}function Wd(t,e,n){if((e=E(e))instanceof Pd)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(Xd)>=0)throw Jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Pd(...e.split("."))._internalPath}catch(i){throw Jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw Jd("Field path arguments must be of type string or ",t,!1,void 0,n)}const Xd=new RegExp("[~\\*/\\[\\]]");function Jd(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new tc(Za.INVALID_ARGUMENT,a+t+c)}function Qd(t,e){return t.some((t=>t.isEqual(e)))}function Yd(t,e){const n=function(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new tc(Za.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_d(t);throw new tc(Za.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}(t.firestore,Rd),i=function(t,e,...n){if(t=E(t),1===arguments.length&&(e=hc.R()),bd("doc","path",e),t instanceof kd){const i=Ic.fromString(e,...n);return Td(i),new Ad(t,null,new Lc(i))}{if(!(t instanceof Ad||t instanceof Nd))throw new tc(Za.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ic.fromString(e,...n));return Td(i),new Ad(t.firestore,t instanceof Nd?t.converter:null,new Lc(i))}}(t),r=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new ec;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=pd(t);try{const t=await function(t,e){const n=Ya(t),i=pc.now(),r=e.reduce(((t,e)=>t.add(e.key)),du());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.Us.Es(t,r).next((r=>{s=r;const o=[];for(const t of e){const e=$l(t,s.get(t.key));null!=e&&o.push(new zl(t.key,e,Wc(e.value.mapValue),Vl.exists(!0)))}return n.gs.addMutationBatch(t,i,o,e)})))).then((t=>(t.applyToLocalDocumentSet(s),{batchId:t.batchId,changes:s})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.$c[t.currentUser.toKey()];i||(i=new eu(dc)),i=i.insert(e,n),t.$c[t.currentUser.toKey()]=i}(i,t.batchId,n),await dd(i,t.changes),await Gh(i.remoteStore)}catch(t){const e=rd(t,"Failed to persist write");n.reject(e)}}(await wd(t),e,n))),n.promise}(function(t){return t._firestoreClient||Dd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[$d(qd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,Vl.exists(!1))]).then((()=>i))}!function(t,e=!0){$a="9.6.8",K(new _("firestore",((t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=new Rd(i,new rc(t.getProvider("auth-internal")),new cc(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),r._setSettings(n),r}),"PUBLIC")),Q(Ba,"3.4.5",t),Q(Ba,"3.4.5","esm2017")}(),function(t=J()){const e=G(t=E(t),jt);e.isInitialized()?e.getImmediate():function(t,e={}){const n=G(t,jt);if(n.isInitialized()){const t=n.getImmediate();if(g(e,n.getOptions()))return t;throw Ht.create("already-initialized")}n.initialize({options:e})}(t)}(function(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw z.create("bad-app-name",{appName:String(i)});const r=q.get(i);if(r){if(g(t,r.options)&&g(n,r.config))return r;throw z.create("duplicate-app",{appName:i})}const s=new A(i);for(const t of $.values())s.addComponent(t);const o=new W(t,n,s);return q.set(i,o),o}({apiKey:"AIzaSyBtD93nbqqlO4zw-CTE_vhP_Skyk3DRrlU",authDomain:"fir-eae97.firebaseapp.com",projectId:"fir-eae97",storageBucket:"fir-eae97.appspot.com",messagingSenderId:"169028157080",appId:"1:169028157080:web:38dd2a8de42c99ba275aed",measurementId:"G-FHW15TD16G"}));const Zd=document.querySelector(".info"),tf=function(t=J()){const e=G(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=G(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(g(n.getOptions(),null!=e?e:{}))return t;de(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Si,persistence:[Wn,Rn,Pn]})}();document.querySelector(".bnn").addEventListener("click",(()=>{if(null===tf.currentUser){let t=document.querySelector(".email").value,e=document.querySelector(".password").value;(function(t,e,n){return async function(t,e){return An(an(t),e)}(E(t),mn.credential(e,n))})(tf,t,e).then((t=>{console.log("signed in")})).catch((t=>{const e=t.code;console.log(e),"auth/invalid-email"!==e&&"auth/wrong-password"!==e&&"auth/user-not-found"!==e||(Zd.innerText="Invalid login credentials.")}))}else Zd.innerText=`User already signed in (${tf.currentUser.email})`})),document.querySelector(".bmm").addEventListener("click",(()=>{(function(t){return E(t).signOut()})(tf).then((()=>{console.log("signed out"),document.body.removeChild(ef)})).catch((t=>{console.log(t)}))}));let ef=document.createElement("div");!function(t,e,n,i){E(t).onAuthStateChanged((t=>{t?(Zd.innerHTML="User signed in","adRGoJje0ZPucbwKjIaR2COPy0v2"==t.uid?(ef.onsubmit=()=>{},ef.innerHTML='\n            Author: <input type="text" name="author" id=\'authorInput\'><br>\n        <span class="error" id=\'e1\'></span><br>\n        Title: <input type="text" name="title" id=\'titleInput\'><br>\n        <span class="error" id=\'e2\'></span><br>\n        <textarea type="text" name="entry" id="textarea" contenteditable="true"></textarea><br>\n        <span class="error" id=\'e3\'></span><br>\n        <input type="submit" id="submit-entry" onclick=\'postBlog()\'>\n            ',document.body.appendChild(ef)):console.log("es incher")):Zd.innerHTML="No user signed in"}),void 0,void 0)}(tf);const nf=function(t=J()){return G(t,"firestore").getImmediate()}();window.postBlog=async()=>{if(function(){let t=!0,e=!0,n=!0,i=document.querySelector("#authorInput"),r=document.querySelector("#titleInput"),s=document.querySelector("#textarea"),o=document.querySelector("#e1"),a=document.querySelector("#e2"),c=document.querySelector("#e3");return""===i.value?(o.innerText="this field cannot be empty",t=!1):(o.innerText="",t=!0),""===r.value?(a.innerText="this field cannot be empty",e=!1):(a.innerText="",e=!0),""===s.value?(c.innerText="this field cannot be empty",n=!1):(c.innerText="",n=!0),t&&e&&n}()){let t=document.querySelector("#authorInput"),e=document.querySelector("#titleInput"),n=document.querySelector("#textarea");try{const i=await Yd(function(t,e,...n){if(t=E(t),bd("collection","path",e),t instanceof kd){const i=Ic.fromString(e,...n);return Ed(i),new Nd(t,null,i)}{if(!(t instanceof Ad||t instanceof Nd))throw new tc(Za.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ic.fromString(e,...n));return Ed(i),new Nd(t.firestore,null,i)}}(nf,"blogPosts"),{author:t.value,title:e.value,content:n.value,date:+new Date});console.log("Document written with ID: ",i.id)}catch(t){console.error("Error adding document: ",t)}}}})()})();